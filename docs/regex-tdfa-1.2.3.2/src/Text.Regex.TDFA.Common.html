<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS -funbox-strict-fields #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- | Common provides simple functions to the backend.  It defines most</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- of the data types.  All modules should call error via the</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- common_error function below.</span><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Regex.TDFA.Common</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.Regex.Base</span><span class="hs-special">(</span><span class="hs-identifier hs-type">RegexOptions</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">{- By Chris Kuklewicz, 2007-2009. BSD License, see the LICENSE file. -}</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Array.IArray</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Array</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Data.IntSet.EnumSet2.html"><span class="hs-identifier">Data.IntSet.EnumSet2</span></a><span class="hs-special">(</span><a href="Data.IntSet.EnumSet2.html#EnumSet"><span class="hs-identifier hs-type">EnumSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.IntSet.EnumSet2.html"><span class="hs-identifier">Data.IntSet.EnumSet2</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span class="hs-special">(</span><a href="Data.IntSet.EnumSet2.html#toList"><span class="hs-identifier hs-var">toList</span></a><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Data.IntMap.CharMap2.html"><span class="hs-identifier">Data.IntMap.CharMap2</span></a><span class="hs-special">(</span><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IntMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IntMap</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.IntMap</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">IMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">findWithDefault</span><span class="hs-special">,</span><span class="hs-identifier hs-var">assocs</span><span class="hs-special">,</span><span class="hs-identifier hs-var">toList</span><span class="hs-special">,</span><span class="hs-identifier hs-var">null</span><span class="hs-special">,</span><span class="hs-identifier hs-var">size</span><span class="hs-special">,</span><span class="hs-identifier hs-var">toAscList</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IntSet</span><span class="hs-special">(</span><span class="hs-identifier hs-type">IntSet</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.IntMap.CharMap2.html"><span class="hs-identifier">Data.IntMap.CharMap2</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span> </span><span class="hs-special">(</span><a href="Data.IntMap.CharMap2.html#assocs"><span class="hs-identifier hs-var">assocs</span></a><span class="hs-special">,</span><a href="Data.IntMap.CharMap2.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span class="hs-special">,</span><a href="Data.IntMap.CharMap2.html#null"><span class="hs-identifier hs-var">null</span></a><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Sequence</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Seq</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-comment">--import Debug.Trace</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Text.Regex.TDFA.IntArrTrieSet.html"><span class="hs-identifier">Text.Regex.TDFA.IntArrTrieSet</span></a><span class="hs-special">(</span><a href="Text.Regex.TDFA.IntArrTrieSet.html#TrieSet"><span class="hs-identifier hs-type">TrieSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">look</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-24"></a><span class="hs-identifier">look</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IntMap</span><span> </span><a href="#local-6989586621679054441"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054441"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-25"></a><a name="look"><a href="Text.Regex.TDFA.Common.html#look"><span class="hs-identifier">look</span></a></a><span> </span><a name="local-6989586621679054442"><a href="#local-6989586621679054442"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679054443"><a href="#local-6989586621679054443"><span class="hs-identifier">imap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">IMap.findWithDefault</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier hs-var">common_error</span></a><span> </span><span class="hs-string">&quot;Text.Regex.DFA.Common&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;key &quot;</span><span class="hs-operator hs-var">++</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679054442"><span class="hs-identifier hs-var">key</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot; not found in look&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679054442"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679054443"><span class="hs-identifier hs-var">imap</span></a><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-identifier">common_error</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054440"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-28"></a><a name="common_error"><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier">common_error</span></a></a><span> </span><a name="local-6989586621679054444"><a href="#local-6989586621679054444"><span class="hs-identifier">moduleName</span></a></a><span> </span><a name="local-6989586621679054445"><a href="#local-6989586621679054445"><span class="hs-identifier">message</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Explict error in module &quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679054444"><span class="hs-identifier hs-var">moduleName</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot; : &quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679054445"><span class="hs-identifier hs-var">message</span></a><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-identifier">on</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054437"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054437"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054438"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054439"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054437"><span class="hs-identifier hs-type">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054439"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054439"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054438"><span class="hs-identifier hs-type">t2</span></a><span>
</span><a name="line-32"></a><a name="local-6989586621679054460"><a href="#local-6989586621679054460"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">`</span><a name="on"><a href="Text.Regex.TDFA.Common.html#on"><span class="hs-identifier">on</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679054461"><a href="#local-6989586621679054461"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679054462"><a href="#local-6989586621679054462"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679054463"><a href="#local-6989586621679054463"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054461"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679054462"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621679054460"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054461"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679054463"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- | after 'sort' or 'sortBy' the use of 'nub'\/'nubBy' can be replaced by 'norep'\/'norepBy'</span><span>
</span><a name="line-35"></a><span class="hs-identifier">norep</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679054436"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679054436"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679054436"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-36"></a><a name="norep"><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier">norep</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-37"></a><span class="hs-identifier">norep</span><span> </span><a name="local-6989586621679054464"><a href="#local-6989586621679054464"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679054464"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-38"></a><span class="hs-identifier">norep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679054465"><a href="#local-6989586621679054465"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679054466"><a href="#local-6989586621679054466"><span class="hs-identifier">bs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679054467"><a href="#local-6989586621679054467"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679054468"><a href="#local-6989586621679054468"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679054465"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679054467"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier hs-var">norep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054465"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679054468"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679054465"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="Text.Regex.TDFA.Common.html#norep"><span class="hs-identifier hs-var">norep</span></a><span> </span><a href="#local-6989586621679054466"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- | after 'sort' or 'sortBy' the use of 'nub'\/'nubBy' can be replaced by 'norep'\/'norepBy'</span><span>
</span><a name="line-42"></a><span class="hs-identifier">norepBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054435"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-43"></a><a name="norepBy"><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier">norepBy</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-44"></a><span class="hs-identifier">norepBy</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679054469"><a href="#local-6989586621679054469"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679054469"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-45"></a><span class="hs-identifier">norepBy</span><span> </span><a name="local-6989586621679054470"><a href="#local-6989586621679054470"><span class="hs-identifier">eqF</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679054471"><a href="#local-6989586621679054471"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679054472"><a href="#local-6989586621679054472"><span class="hs-identifier">bs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679054473"><a href="#local-6989586621679054473"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679054474"><a href="#local-6989586621679054474"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679054471"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679054470"><span class="hs-identifier hs-var">eqF</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679054473"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier hs-var">norepBy</span></a><span> </span><a href="#local-6989586621679054470"><span class="hs-identifier hs-var">eqF</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054471"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679054474"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679054471"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="Text.Regex.TDFA.Common.html#norepBy"><span class="hs-identifier hs-var">norepBy</span></a><span> </span><a href="#local-6989586621679054470"><span class="hs-identifier hs-var">eqF</span></a><span> </span><a href="#local-6989586621679054472"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-identifier">mapFst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679054431"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054432"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054433"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054431"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054432"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679054434"><span class="hs-identifier hs-type">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054431"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054433"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679054434"><span class="hs-identifier hs-type">t1</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><a name="mapFst"><a href="Text.Regex.TDFA.Common.html#mapFst"><span class="hs-identifier">mapFst</span></a></a><span> </span><a name="local-6989586621679054475"><a href="#local-6989586621679054475"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679054476"><a href="#local-6989586621679054476"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679054477"><a href="#local-6989586621679054477"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054475"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679054476"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679054477"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-identifier">mapSnd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679054427"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054428"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054429"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054427"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054430"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679054428"><span class="hs-identifier hs-type">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054427"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054430"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679054429"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><a name="mapSnd"><a href="Text.Regex.TDFA.Common.html#mapSnd"><span class="hs-identifier">mapSnd</span></a></a><span> </span><a name="local-6989586621679054478"><a href="#local-6989586621679054478"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679054479"><a href="#local-6989586621679054479"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679054480"><a href="#local-6989586621679054480"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054479"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679054478"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679054480"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-identifier">fst3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054424"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679054425"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679054426"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054424"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-55"></a><a name="fst3"><a href="Text.Regex.TDFA.Common.html#fst3"><span class="hs-identifier">fst3</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679054481"><a href="#local-6989586621679054481"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679054481"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">snd3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054421"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679054422"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679054423"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054422"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-58"></a><a name="snd3"><a href="Text.Regex.TDFA.Common.html#snd3"><span class="hs-identifier">snd3</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679054482"><a href="#local-6989586621679054482"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679054482"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-identifier">thd3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054418"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679054419"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679054420"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054420"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-61"></a><a name="thd3"><a href="Text.Regex.TDFA.Common.html#thd3"><span class="hs-identifier">thd3</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679054483"><a href="#local-6989586621679054483"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679054483"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-identifier">flipOrder</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-64"></a><a name="flipOrder"><a href="Text.Regex.TDFA.Common.html#flipOrder"><span class="hs-identifier">flipOrder</span></a></a><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-65"></a><span class="hs-identifier">flipOrder</span><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-66"></a><span class="hs-identifier">flipOrder</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-identifier">noWin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#WinTags"><span class="hs-identifier hs-type">WinTags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-69"></a><a name="noWin"><a href="Text.Regex.TDFA.Common.html#noWin"><span class="hs-identifier">noWin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- | Used to track elements of the pattern that accept characters or </span><span>
</span><a name="line-72"></a><span class="hs-comment">-- are anchors</span><span>
</span><a name="line-73"></a><span class="hs-keyword">newtype</span><span> </span><a name="DoPa"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier">DoPa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DoPa"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier">DoPa</span></a></a><span> </span><span class="hs-special">{</span><a name="dopaIndex"><a href="Text.Regex.TDFA.Common.html#dopaIndex"><span class="hs-identifier">dopaIndex</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-76"></a><span>  </span><a name="local-8214565720323790311"><span class="hs-identifier">toEnum</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-var">DoPa</span></a><span>
</span><a name="line-77"></a><span>  </span><a name="local-8214565720323790310"><span class="hs-identifier">fromEnum</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dopaIndex</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-80"></a><span>  </span><a name="local-8214565720323790324"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679054416"><a href="#local-6989586621679054416"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-var">DoPa</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">dopaIndex</span><span class="hs-glyph">=</span><a name="local-6989586621679054417"><a href="#local-6989586621679054417"><span class="hs-identifier">i</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-char">'#'</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679054416"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679054417"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | Control whether the pattern is multiline or case-sensitive like Text.Regex and whether to</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- capture the subgroups (\\1, \\2, etc).  Controls enabling extra anchor syntax.</span><span>
</span><a name="line-84"></a><span class="hs-keyword">data</span><span> </span><a name="CompOption"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier">CompOption</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CompOption"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier">CompOption</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-85"></a><span>    </span><a name="caseSensitive"><a href="Text.Regex.TDFA.Common.html#caseSensitive"><span class="hs-identifier">caseSensitive</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>    </span><span class="hs-comment">-- ^ True in blankCompOpt and defaultCompOpt</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="multiline"><a href="Text.Regex.TDFA.Common.html#multiline"><span class="hs-identifier">multiline</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">{- ^ False in blankCompOpt, True in defaultCompOpt. Compile for
                      newline-sensitive matching.  &quot;By default, newline is a completely ordinary
                      character with no special meaning in either REs or strings.  With this flag,
                      inverted bracket expressions and . never match newline, a ^ anchor matches the
                      null string after any newline in the string in addition to its normal
                      function, and the $ anchor matches the null string before any newline in the
                      string in addition to its normal function.&quot; -}</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="rightAssoc"><a href="Text.Regex.TDFA.Common.html#rightAssoc"><span class="hs-identifier">rightAssoc</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>       </span><span class="hs-comment">-- ^ True (and therefore Right associative) in blankCompOpt and defaultCompOpt</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="newSyntax"><a href="Text.Regex.TDFA.Common.html#newSyntax"><span class="hs-identifier">newSyntax</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>        </span><span class="hs-comment">-- ^ False in blankCompOpt, True in defaultCompOpt. Add the extended non-POSIX syntax described in &quot;Text.Regex.TDFA&quot; haddock documentation.</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="lastStarGreedy"><a href="Text.Regex.TDFA.Common.html#lastStarGreedy"><span class="hs-identifier">lastStarGreedy</span></a></a><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-identifier hs-type">Bool</span><span>  </span><span class="hs-comment">-- ^ False by default.  This is POSIX correct but it takes space and is slower.</span><span>
</span><a name="line-96"></a><span>                            </span><span class="hs-comment">-- Setting this to true will improve performance, and should be done</span><span>
</span><a name="line-97"></a><span>                            </span><span class="hs-comment">-- if you plan to set the captureGroups execoption to False.</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-keyword">data</span><span> </span><a name="ExecOption"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier">ExecOption</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ExecOption"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier">ExecOption</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-101"></a><span>    </span><a name="captureGroups"><a href="Text.Regex.TDFA.Common.html#captureGroups"><span class="hs-identifier">captureGroups</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>    </span><span class="hs-comment">-- ^ True by default.  Set to False to improve speed (and space).</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- | Used by implementation to name certain Postions during</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- matching. Identity of Position tag to set during a transition</span><span>
</span><a name="line-106"></a><span class="hs-keyword">type</span><span> </span><a name="Tag"><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier">Tag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- | Internal use to indicate type of tag and preference for larger or smaller Positions</span><span>
</span><a name="line-108"></a><span class="hs-keyword">data</span><span> </span><a name="OP"><a href="Text.Regex.TDFA.Common.html#OP"><span class="hs-identifier">OP</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Maximize"><a href="Text.Regex.TDFA.Common.html#Maximize"><span class="hs-identifier">Maximize</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Minimize"><a href="Text.Regex.TDFA.Common.html#Minimize"><span class="hs-identifier">Minimize</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Orbit"><a href="Text.Regex.TDFA.Common.html#Orbit"><span class="hs-identifier">Orbit</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ignore"><a href="Text.Regex.TDFA.Common.html#Ignore"><span class="hs-identifier">Ignore</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- | Internal NFA node identity number</span><span>
</span><a name="line-110"></a><span class="hs-keyword">type</span><span> </span><a name="Index"><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier">Index</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-111"></a><span class="hs-comment">-- | Internal DFA identity is this Set of NFA Index</span><span>
</span><a name="line-112"></a><span class="hs-keyword">type</span><span> </span><a name="SetIndex"><a href="Text.Regex.TDFA.Common.html#SetIndex"><span class="hs-identifier">SetIndex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IntSet</span><span> </span><span class="hs-comment">{- Index -}</span><span>
</span><a name="line-113"></a><span class="hs-comment">-- | Index into the text being searched</span><span>
</span><a name="line-114"></a><span class="hs-keyword">type</span><span> </span><a name="Position"><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier">Position</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- | GroupIndex is for indexing submatches from capturing</span><span>
</span><a name="line-117"></a><span class="hs-comment">-- parenthesized groups (PGroup\/Group)</span><span>
</span><a name="line-118"></a><span class="hs-keyword">type</span><span> </span><a name="GroupIndex"><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier">GroupIndex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- | GroupInfo collects the parent and tag information for an instance </span><span>
</span><a name="line-120"></a><span class="hs-comment">-- of a group</span><span>
</span><a name="line-121"></a><span class="hs-keyword">data</span><span> </span><a name="GroupInfo"><a href="Text.Regex.TDFA.Common.html#GroupInfo"><span class="hs-identifier">GroupInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="GroupInfo"><a href="Text.Regex.TDFA.Common.html#GroupInfo"><span class="hs-identifier">GroupInfo</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-122"></a><span>    </span><a name="thisIndex"><a href="Text.Regex.TDFA.Common.html#thisIndex"><span class="hs-identifier">thisIndex</span></a></a><span class="hs-special">,</span><span> </span><a name="parentIndex"><a href="Text.Regex.TDFA.Common.html#parentIndex"><span class="hs-identifier">parentIndex</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier hs-type">GroupIndex</span></a><span>
</span><a name="line-123"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="startTag"><a href="Text.Regex.TDFA.Common.html#startTag"><span class="hs-identifier">startTag</span></a></a><span class="hs-special">,</span><span> </span><a name="stopTag"><a href="Text.Regex.TDFA.Common.html#stopTag"><span class="hs-identifier">stopTag</span></a></a><span class="hs-special">,</span><span> </span><a name="flagTag"><a href="Text.Regex.TDFA.Common.html#flagTag"><span class="hs-identifier">flagTag</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | The TDFA backend specific 'Regex' type, used by this module's RegexOptions and RegexMaker</span><span>
</span><a name="line-127"></a><span class="hs-keyword">data</span><span> </span><a name="Regex"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier">Regex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Regex"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier">Regex</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-128"></a><span>    </span><a name="regex_dfa"><a href="Text.Regex.TDFA.Common.html#regex_dfa"><span class="hs-identifier">regex_dfa</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-type">DFA</span></a><span>                             </span><span class="hs-comment">-- ^ starting DFA state</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_init"><a href="Text.Regex.TDFA.Common.html#regex_init"><span class="hs-identifier">regex_init</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a><span>                          </span><span class="hs-comment">-- ^ index of starting state</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_b_index"><a href="Text.Regex.TDFA.Common.html#regex_b_index"><span class="hs-identifier">regex_b_index</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a><span class="hs-special">)</span><span>               </span><span class="hs-comment">-- ^ indexes of smallest and largest states</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_b_tags"><a href="Text.Regex.TDFA.Common.html#regex_b_tags"><span class="hs-identifier">regex_b_tags</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span class="hs-special">)</span><span>                    </span><span class="hs-comment">-- ^ indexes of smallest and largest tags</span><span>
</span><a name="line-132"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_trie"><a href="Text.Regex.TDFA.Common.html#regex_trie"><span class="hs-identifier">regex_trie</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.IntArrTrieSet.html#TrieSet"><span class="hs-identifier hs-type">TrieSet</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-type">DFA</span></a><span>                    </span><span class="hs-comment">-- ^ All DFA states</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_tags"><a href="Text.Regex.TDFA.Common.html#regex_tags"><span class="hs-identifier">regex_tags</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Array</span><span> </span><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#OP"><span class="hs-identifier hs-type">OP</span></a><span>                   </span><span class="hs-comment">-- ^ information about each tag</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_groups"><a href="Text.Regex.TDFA.Common.html#regex_groups"><span class="hs-identifier">regex_groups</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Array</span><span> </span><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier hs-type">GroupIndex</span></a><span> </span><span class="hs-special">[</span><a href="Text.Regex.TDFA.Common.html#GroupInfo"><span class="hs-identifier hs-type">GroupInfo</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ information about each group</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_isFrontAnchored"><a href="Text.Regex.TDFA.Common.html#regex_isFrontAnchored"><span class="hs-identifier">regex_isFrontAnchored</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                </span><span class="hs-comment">-- ^ used for optimizing execution</span><span>
</span><a name="line-136"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_compOptions"><a href="Text.Regex.TDFA.Common.html#regex_compOptions"><span class="hs-identifier">regex_compOptions</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a><span>
</span><a name="line-137"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="regex_execOptions"><a href="Text.Regex.TDFA.Common.html#regex_execOptions"><span class="hs-identifier">regex_execOptions</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a><span>
</span><a name="line-138"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- no deriving at all, the DFA may be too big to ever traverse!</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">RegexOptions</span><span> </span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-142"></a><span>  </span><a name="local-8214565720323793825"><span class="hs-identifier">blankCompOpt</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">caseSensitive</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-143"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">multiline</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-144"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rightAssoc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-145"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">newSyntax</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-146"></a><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lastStarGreedy</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-147"></a><span>                             </span><span class="hs-special">}</span><span>
</span><a name="line-148"></a><span>  </span><a name="local-8214565720323793824"><span class="hs-identifier">blankExecOpt</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">captureGroups</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-149"></a><span>  </span><a name="local-8214565720323793823"><span class="hs-identifier">defaultCompOpt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">caseSensitive</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-150"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">multiline</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-151"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rightAssoc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-152"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">newSyntax</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-153"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lastStarGreedy</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-154"></a><span>                              </span><span class="hs-special">}</span><span>
</span><a name="line-155"></a><span>  </span><a name="local-8214565720323793822"><span class="hs-identifier">defaultExecOpt</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">captureGroups</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-156"></a><span>  </span><a name="local-8214565720323793821"><span class="hs-identifier">setExecOpts</span></a><span> </span><a name="local-6989586621679054413"><a href="#local-6989586621679054413"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679054414"><a href="#local-6989586621679054414"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679054414"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">regex_execOptions</span><span class="hs-glyph">=</span><a href="#local-6989586621679054413"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">}</span><span>
</span><a name="line-157"></a><span>  </span><a name="local-8214565720323793820"><span class="hs-identifier">getExecOpts</span></a><span> </span><a name="local-6989586621679054415"><a href="#local-6989586621679054415"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">regex_execOptions</span><span> </span><a href="#local-6989586621679054415"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">data</span><span> </span><a name="WinEmpty"><a href="Text.Regex.TDFA.Common.html#WinEmpty"><span class="hs-identifier">WinEmpty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WinEmpty"><a href="Text.Regex.TDFA.Common.html#WinEmpty"><span class="hs-identifier">WinEmpty</span></a></a><span> </span><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a><span>
</span><a name="line-161"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="WinTest"><a href="Text.Regex.TDFA.Common.html#WinTest"><span class="hs-identifier">WinTest</span></a></a><span> </span><a href="Text.Regex.TDFA.Common.html#WhichTest"><span class="hs-identifier hs-type">WhichTest</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Text.Regex.TDFA.Common.html#WinEmpty"><span class="hs-identifier hs-type">WinEmpty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Text.Regex.TDFA.Common.html#WinEmpty"><span class="hs-identifier hs-type">WinEmpty</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | Internal NFA node type</span><span>
</span><a name="line-165"></a><span class="hs-keyword">data</span><span> </span><a name="QNFA"><a href="Text.Regex.TDFA.Common.html#QNFA"><span class="hs-identifier">QNFA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="QNFA"><a href="Text.Regex.TDFA.Common.html#QNFA"><span class="hs-identifier">QNFA</span></a></a><span> </span><span class="hs-special">{</span><a name="q_id"><a href="Text.Regex.TDFA.Common.html#q_id"><span class="hs-identifier">q_id</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a><span class="hs-special">,</span><span> </span><a name="q_qt"><a href="Text.Regex.TDFA.Common.html#q_qt"><span class="hs-identifier">q_qt</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a><span class="hs-special">}</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | Internal to QNFA type.</span><span>
</span><a name="line-168"></a><span class="hs-keyword">data</span><span> </span><a name="QT"><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier">QT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Simple"><a href="Text.Regex.TDFA.Common.html#Simple"><span class="hs-identifier">Simple</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="qt_win"><a href="Text.Regex.TDFA.Common.html#qt_win"><span class="hs-identifier">qt_win</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#WinTags"><span class="hs-identifier hs-type">WinTags</span></a><span> </span><span class="hs-comment">-- ^ empty transitions to the virtual winning state</span><span>
</span><a name="line-169"></a><span>                 </span><span class="hs-special">,</span><span> </span><a name="qt_trans"><a href="Text.Regex.TDFA.Common.html#qt_trans"><span class="hs-identifier">qt_trans</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a><span> </span><span class="hs-comment">-- ^ all ways to leave this QNFA to other or the same QNFA</span><span>
</span><a name="line-170"></a><span>                 </span><span class="hs-special">,</span><span> </span><a name="qt_other"><a href="Text.Regex.TDFA.Common.html#qt_other"><span class="hs-identifier">qt_other</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a><span> </span><span class="hs-comment">-- ^ default ways to leave this QNFA to other or the same QNFA</span><span>
</span><a name="line-171"></a><span>                 </span><span class="hs-special">}</span><span>
</span><a name="line-172"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="Testing"><a href="Text.Regex.TDFA.Common.html#Testing"><span class="hs-identifier">Testing</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="qt_test"><a href="Text.Regex.TDFA.Common.html#qt_test"><span class="hs-identifier">qt_test</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#WhichTest"><span class="hs-identifier hs-type">WhichTest</span></a><span> </span><span class="hs-comment">-- ^ The test to perform</span><span>
</span><a name="line-173"></a><span>                  </span><span class="hs-special">,</span><span> </span><a name="qt_dopas"><a href="Text.Regex.TDFA.Common.html#qt_dopas"><span class="hs-identifier">qt_dopas</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.EnumSet2.html#EnumSet"><span class="hs-identifier hs-type">EnumSet</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a><span>  </span><span class="hs-comment">-- ^ location(s) of the anchor(s) in the original regexp</span><span>
</span><a name="line-174"></a><span>                  </span><span class="hs-special">,</span><span> </span><a name="qt_a"><a href="Text.Regex.TDFA.Common.html#qt_a"><span class="hs-identifier">qt_a</span></a></a><span class="hs-special">,</span><span> </span><a name="qt_b"><a href="Text.Regex.TDFA.Common.html#qt_b"><span class="hs-identifier">qt_b</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a><span> </span><span class="hs-comment">-- ^ use qt_a if test is True, else use qt_b</span><span>
</span><a name="line-175"></a><span>                  </span><span class="hs-special">}</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- | Internal type to represent the tagged transition from one QNFA to</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- another (or itself).  The key is the Index of the destination QNFA.</span><span>
</span><a name="line-179"></a><span class="hs-keyword">type</span><span> </span><a name="QTrans"><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier">QTrans</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IntMap</span><span> </span><span class="hs-comment">{- Destination Index -}</span><span> </span><span class="hs-special">[</span><a href="Text.Regex.TDFA.Common.html#TagCommand"><span class="hs-identifier hs-type">TagCommand</span></a><span class="hs-special">]</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- | Known predicates, just Beginning of Line (^) and End of Line ($).</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- Also support for GNU extensions is being added: \\\` beginning of</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- buffer, \\\' end of buffer, \\\&lt; and \\\&gt; for begin and end of words, \\b</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- and \\B for word boundary and not word boundary.</span><span>
</span><a name="line-185"></a><span class="hs-keyword">data</span><span> </span><a name="WhichTest"><a href="Text.Regex.TDFA.Common.html#WhichTest"><span class="hs-identifier">WhichTest</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Test_BOL"><a href="Text.Regex.TDFA.Common.html#Test_BOL"><span class="hs-identifier">Test_BOL</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Test_EOL"><a href="Text.Regex.TDFA.Common.html#Test_EOL"><span class="hs-identifier">Test_EOL</span></a></a><span> </span><span class="hs-comment">-- '^' and '$' (affected by multiline option)</span><span>
</span><a name="line-186"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Test_BOB"><a href="Text.Regex.TDFA.Common.html#Test_BOB"><span class="hs-identifier">Test_BOB</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Test_EOB"><a href="Text.Regex.TDFA.Common.html#Test_EOB"><span class="hs-identifier">Test_EOB</span></a></a><span> </span><span class="hs-comment">-- \` and \' begin and end buffer</span><span>
</span><a name="line-187"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Test_BOW"><a href="Text.Regex.TDFA.Common.html#Test_BOW"><span class="hs-identifier">Test_BOW</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Test_EOW"><a href="Text.Regex.TDFA.Common.html#Test_EOW"><span class="hs-identifier">Test_EOW</span></a></a><span> </span><span class="hs-comment">-- \&lt; and \&gt; begin and end word</span><span>
</span><a name="line-188"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Test_EdgeWord"><a href="Text.Regex.TDFA.Common.html#Test_EdgeWord"><span class="hs-identifier">Test_EdgeWord</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Test_NotEdgeWord"><a href="Text.Regex.TDFA.Common.html#Test_NotEdgeWord"><span class="hs-identifier">Test_NotEdgeWord</span></a></a><span> </span><span class="hs-comment">-- \b and \B word boundaries</span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- | The things that can be done with a Tag.  TagTask and</span><span>
</span><a name="line-192"></a><span class="hs-comment">-- ResetGroupStopTask are for tags with Maximize or Minimize OP</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- values.  ResetOrbitTask and EnterOrbitTask and LeaveOrbitTask are</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- for tags with Orbit OP value.</span><span>
</span><a name="line-195"></a><span class="hs-keyword">data</span><span> </span><a name="TagTask"><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier">TagTask</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TagTask"><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier">TagTask</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ResetGroupStopTask"><a href="Text.Regex.TDFA.Common.html#ResetGroupStopTask"><span class="hs-identifier">ResetGroupStopTask</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="SetGroupStopTask"><a href="Text.Regex.TDFA.Common.html#SetGroupStopTask"><span class="hs-identifier">SetGroupStopTask</span></a></a><span>
</span><a name="line-196"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="ResetOrbitTask"><a href="Text.Regex.TDFA.Common.html#ResetOrbitTask"><span class="hs-identifier">ResetOrbitTask</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="EnterOrbitTask"><a href="Text.Regex.TDFA.Common.html#EnterOrbitTask"><span class="hs-identifier">EnterOrbitTask</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="LeaveOrbitTask"><a href="Text.Regex.TDFA.Common.html#LeaveOrbitTask"><span class="hs-identifier">LeaveOrbitTask</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-comment">-- | Ordered list of tags and their associated Task</span><span>
</span><a name="line-199"></a><span class="hs-keyword">type</span><span> </span><a name="TagTasks"><a href="Text.Regex.TDFA.Common.html#TagTasks"><span class="hs-identifier">TagTasks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier hs-type">TagTask</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- | When attached to a QTrans the TagTask can be done before or after</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- accepting the character.</span><span>
</span><a name="line-202"></a><span class="hs-keyword">data</span><span> </span><a name="TagUpdate"><a href="Text.Regex.TDFA.Common.html#TagUpdate"><span class="hs-identifier">TagUpdate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PreUpdate"><a href="Text.Regex.TDFA.Common.html#PreUpdate"><span class="hs-identifier">PreUpdate</span></a></a><span> </span><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier hs-type">TagTask</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="PostUpdate"><a href="Text.Regex.TDFA.Common.html#PostUpdate"><span class="hs-identifier">PostUpdate</span></a></a><span> </span><a href="Text.Regex.TDFA.Common.html#TagTask"><span class="hs-identifier hs-type">TagTask</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- | Ordered list of tags and their associated update operation.</span><span>
</span><a name="line-204"></a><span class="hs-keyword">type</span><span> </span><a name="TagList"><a href="Text.Regex.TDFA.Common.html#TagList"><span class="hs-identifier">TagList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#TagUpdate"><span class="hs-identifier hs-type">TagUpdate</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-205"></a><span class="hs-comment">-- | A TagList and the location of the item in the original pattern</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- that is being accepted.</span><span>
</span><a name="line-207"></a><span class="hs-keyword">type</span><span> </span><a name="TagCommand"><a href="Text.Regex.TDFA.Common.html#TagCommand"><span class="hs-identifier">TagCommand</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#TagList"><span class="hs-identifier hs-type">TagList</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- | Ordered list of tags and their associated update operation to</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- perform on an empty transition to the virtual winning state.</span><span>
</span><a name="line-210"></a><span class="hs-keyword">type</span><span> </span><a name="WinTags"><a href="Text.Regex.TDFA.Common.html#WinTags"><span class="hs-identifier">WinTags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#TagList"><span class="hs-identifier hs-type">TagList</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Internal DFA node, identified by the Set of indices of the QNFA</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- nodes it represents.</span><span>
</span><a name="line-214"></a><span class="hs-keyword">data</span><span> </span><a name="DFA"><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier">DFA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DFA"><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier">DFA</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="d_id"><a href="Text.Regex.TDFA.Common.html#d_id"><span class="hs-identifier">d_id</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#SetIndex"><span class="hs-identifier hs-type">SetIndex</span></a><span class="hs-special">,</span><span> </span><a name="d_dt"><a href="Text.Regex.TDFA.Common.html#d_dt"><span class="hs-identifier">d_dt</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-type">DT</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span class="hs-keyword">data</span><span> </span><a name="Transition"><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier">Transition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Transition"><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier">Transition</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="trans_many"><a href="Text.Regex.TDFA.Common.html#trans_many"><span class="hs-identifier">trans_many</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-type">DFA</span></a><span>    </span><span class="hs-comment">-- ^ where to go (maximal), including respawning</span><span>
</span><a name="line-216"></a><span>                             </span><span class="hs-special">,</span><span> </span><a name="trans_single"><a href="Text.Regex.TDFA.Common.html#trans_single"><span class="hs-identifier">trans_single</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#DFA"><span class="hs-identifier hs-type">DFA</span></a><span>  </span><span class="hs-comment">-- ^ where to go, not including respawning</span><span>
</span><a name="line-217"></a><span>                             </span><span class="hs-special">,</span><span> </span><a name="trans_how"><a href="Text.Regex.TDFA.Common.html#trans_how"><span class="hs-identifier">trans_how</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#DTrans"><span class="hs-identifier hs-type">DTrans</span></a><span>    </span><span class="hs-comment">-- ^ how to go, including respawning</span><span>
</span><a name="line-218"></a><span>                             </span><span class="hs-special">}</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- | Internal to the DFA node</span><span>
</span><a name="line-220"></a><span class="hs-keyword">data</span><span> </span><a name="DT"><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier">DT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Simple%27"><a href="Text.Regex.TDFA.Common.html#Simple%27"><span class="hs-identifier">Simple'</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="dt_win"><a href="Text.Regex.TDFA.Common.html#dt_win"><span class="hs-identifier">dt_win</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IntMap</span><span> </span><span class="hs-comment">{- Source Index -}</span><span> </span><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a><span> </span><span class="hs-comment">-- ^ Actions to perform to win</span><span>
</span><a name="line-221"></a><span>                  </span><span class="hs-special">,</span><span> </span><a name="dt_trans"><a href="Text.Regex.TDFA.Common.html#dt_trans"><span class="hs-identifier">dt_trans</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-type">Transition</span></a><span> </span><span class="hs-comment">-- ^ Transition to accept Char</span><span>
</span><a name="line-222"></a><span>                  </span><span class="hs-special">,</span><span> </span><a name="dt_other"><a href="Text.Regex.TDFA.Common.html#dt_other"><span class="hs-identifier">dt_other</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-type">Transition</span></a><span> </span><span class="hs-comment">-- ^ default accepting transition</span><span>
</span><a name="line-223"></a><span>                  </span><span class="hs-special">}</span><span>
</span><a name="line-224"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="Testing%27"><a href="Text.Regex.TDFA.Common.html#Testing%27"><span class="hs-identifier">Testing'</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="dt_test"><a href="Text.Regex.TDFA.Common.html#dt_test"><span class="hs-identifier">dt_test</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#WhichTest"><span class="hs-identifier hs-type">WhichTest</span></a><span> </span><span class="hs-comment">-- ^ The test to perform</span><span>
</span><a name="line-225"></a><span>                   </span><span class="hs-special">,</span><span> </span><a name="dt_dopas"><a href="Text.Regex.TDFA.Common.html#dt_dopas"><span class="hs-identifier">dt_dopas</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.EnumSet2.html#EnumSet"><span class="hs-identifier hs-type">EnumSet</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a><span> </span><span class="hs-comment">-- ^ location(s) of the anchor(s) in the original regexp</span><span>
</span><a name="line-226"></a><span>                   </span><span class="hs-special">,</span><span> </span><a name="dt_a"><a href="Text.Regex.TDFA.Common.html#dt_a"><span class="hs-identifier">dt_a</span></a></a><span class="hs-special">,</span><a name="dt_b"><a href="Text.Regex.TDFA.Common.html#dt_b"><span class="hs-identifier">dt_b</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-type">DT</span></a><span>      </span><span class="hs-comment">-- ^ use dt_a if test is True else use dt_b</span><span>
</span><a name="line-227"></a><span>                   </span><span class="hs-special">}</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">-- | Internal type to repesent the commands for the tagged transition.</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- The outer IntMap is for the destination Index and the inner IntMap</span><span>
</span><a name="line-231"></a><span class="hs-comment">-- is for the Source Index.  This is convenient since all runtime data</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- going to the same destination must be compared to find the best.</span><span>
</span><a name="line-233"></a><span class="hs-comment">--</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- A Destination IntMap entry may have an empty Source IntMap if and</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- only if the destination is the starting index and the NFA\/DFA.</span><span>
</span><a name="line-236"></a><span class="hs-comment">-- This instructs the matching engine to spawn a new entry starting at</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- the post-update position.</span><span>
</span><a name="line-238"></a><span class="hs-keyword">type</span><span> </span><a name="DTrans"><a href="Text.Regex.TDFA.Common.html#DTrans"><span class="hs-identifier">DTrans</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IntMap</span><span> </span><span class="hs-comment">{- Index of Destination -}</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IntMap</span><span> </span><span class="hs-comment">{- Index of Source -}</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span class="hs-comment">-- type DTrans = IntMap {- Index of Destination -} (IntMap {- Index of Source -} (DoPa,RunState ()))</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- | Internal convenience type for the text display code</span><span>
</span><a name="line-241"></a><span class="hs-keyword">type</span><span> </span><a name="DTrans%27"><a href="Text.Regex.TDFA.Common.html#DTrans%27"><span class="hs-identifier">DTrans'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-type">Position</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">-- | Positions for which a * was re-started while looping.  Need to</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- append locations at back but compare starting with front, so use</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- Seq as a Queue.  The initial position is saved in basePos (and a</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- Maximize Tag), the middle positions in the Seq, and the final</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- position is NOT saved in the Orbits (only in a Maximize Tag).</span><span>
</span><a name="line-248"></a><span class="hs-comment">--</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- The orderinal code is being written XXX TODO document it.</span><span>
</span><a name="line-250"></a><span class="hs-keyword">data</span><span> </span><a name="Orbits"><a href="Text.Regex.TDFA.Common.html#Orbits"><span class="hs-identifier">Orbits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Orbits"><a href="Text.Regex.TDFA.Common.html#Orbits"><span class="hs-identifier">Orbits</span></a></a><span>
</span><a name="line-251"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="inOrbit"><a href="Text.Regex.TDFA.Common.html#inOrbit"><span class="hs-identifier">inOrbit</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Bool</span><span>        </span><span class="hs-comment">-- True if enterOrbit, False if LeaveOrbit</span><span>
</span><a name="line-252"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="basePos"><a href="Text.Regex.TDFA.Common.html#basePos"><span class="hs-identifier">basePos</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-type">Position</span></a><span>
</span><a name="line-253"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="ordinal"><a href="Text.Regex.TDFA.Common.html#ordinal"><span class="hs-identifier">ordinal</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="getOrbits"><a href="Text.Regex.TDFA.Common.html#getOrbits"><span class="hs-identifier">getOrbits</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Seq</span><span> </span><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-type">Position</span></a><span class="hs-special">)</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-comment">-- | The 'newPos' and 'newFlags' lists in Instructions are sorted by, and unique in, the Tag values</span><span>
</span><a name="line-258"></a><span class="hs-keyword">data</span><span> </span><a name="Instructions"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier">Instructions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Instructions"><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier">Instructions</span></a></a><span>
</span><a name="line-259"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="newPos"><a href="Text.Regex.TDFA.Common.html#newPos"><span class="hs-identifier">newPos</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#Action"><span class="hs-identifier hs-type">Action</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- False is preUpdate, True is postUpdate (there are no Orbit tags here) -- 2009 : Change to enum from bool?</span><span>
</span><a name="line-260"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="newOrbits"><a href="Text.Regex.TDFA.Common.html#newOrbits"><span class="hs-identifier">newOrbits</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.Regex.TDFA.Common.html#OrbitTransformer"><span class="hs-identifier hs-type">OrbitTransformer</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-type">Instructions</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-264"></a><span>  </span><a name="local-8214565720323790324"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679054411"><a href="#local-6989586621679054411"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Instructions"><span class="hs-identifier hs-var">Instructions</span></a><span> </span><a name="local-6989586621679054412"><a href="#local-6989586621679054412"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showParen</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054411"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">11</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-266"></a><span>        </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;Instructions {&quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-267"></a><span>        </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;newPos = &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-268"></a><span>        </span><span class="hs-identifier hs-var">showsPrec</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679054412"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-269"></a><span>        </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-270"></a><span>        </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;newOrbits = &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-271"></a><span>        </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;&lt;function&gt;&quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-272"></a><span>        </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;}&quot;</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-keyword">data</span><span> </span><a name="Action"><a href="Text.Regex.TDFA.Common.html#Action"><span class="hs-identifier">Action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SetPre"><a href="Text.Regex.TDFA.Common.html#SetPre"><span class="hs-identifier">SetPre</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="SetPost"><a href="Text.Regex.TDFA.Common.html#SetPost"><span class="hs-identifier">SetPost</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="SetVal"><a href="Text.Regex.TDFA.Common.html#SetVal"><span class="hs-identifier">SetVal</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span class="hs-keyword">type</span><span> </span><a name="OrbitTransformer"><a href="Text.Regex.TDFA.Common.html#OrbitTransformer"><span class="hs-identifier">OrbitTransformer</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#OrbitLog"><span class="hs-identifier hs-type">OrbitLog</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.Regex.TDFA.Common.html#OrbitLog"><span class="hs-identifier hs-type">OrbitLog</span></a><span>
</span><a name="line-276"></a><span class="hs-keyword">type</span><span> </span><a name="OrbitLog"><a href="Text.Regex.TDFA.Common.html#OrbitLog"><span class="hs-identifier">OrbitLog</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IntMap</span><span> </span><a href="Text.Regex.TDFA.Common.html#Orbits"><span class="hs-identifier hs-type">Orbits</span></a><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Text.Regex.TDFA.Common.html#QNFA"><span class="hs-identifier hs-type">QNFA</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-279"></a><span>  </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#QNFA"><span class="hs-identifier hs-var">QNFA</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">q_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679054409"><a href="#local-6989586621679054409"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">q_qt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679054410"><a href="#local-6989586621679054410"><span class="hs-identifier">qt</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;QNFA {q_id = &quot;</span><span class="hs-operator hs-var">++</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679054409"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-280"></a><span>                                  </span><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;\n     ,q_qt = &quot;</span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679054410"><span class="hs-identifier hs-var">qt</span></a><span>
</span><a name="line-281"></a><span>                                  </span><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;\n}&quot;</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-284"></a><span>  </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#showQT"><span class="hs-identifier hs-var">showQT</span></a><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-identifier">showQT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-287"></a><a name="showQT"><a href="Text.Regex.TDFA.Common.html#showQT"><span class="hs-identifier">showQT</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Simple"><span class="hs-identifier hs-var">Simple</span></a><span> </span><a name="local-6989586621679054484"><a href="#local-6989586621679054484"><span class="hs-identifier">win</span></a></a><span> </span><a name="local-6989586621679054485"><a href="#local-6989586621679054485"><span class="hs-identifier">trans</span></a></a><span> </span><a name="local-6989586621679054486"><a href="#local-6989586621679054486"><span class="hs-identifier">other</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;{qt_win=&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679054484"><span class="hs-identifier hs-var">win</span></a><span>
</span><a name="line-288"></a><span>                             </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n, qt_trans=&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054487"><span class="hs-identifier hs-var">foo</span></a><span> </span><a href="#local-6989586621679054485"><span class="hs-identifier hs-var">trans</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>                             </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n, qt_other=&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054488"><span class="hs-identifier hs-var">foo'</span></a><span> </span><a href="#local-6989586621679054486"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;}&quot;</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">foo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-type">CharMap</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="Text.Regex.TDFA.Common.html#TagCommand"><span class="hs-identifier hs-type">TagCommand</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-291"></a><span>        </span><a name="local-6989586621679054487"><a href="#local-6989586621679054487"><span class="hs-identifier">foo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a><span> </span><a href="#local-6989586621679054488"><span class="hs-identifier hs-var">foo'</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.IntMap.CharMap2.html#toAscList"><span class="hs-identifier hs-var">Map.toAscList</span></a><span>
</span><a name="line-292"></a><span>        </span><span class="hs-identifier">foo'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Index"><span class="hs-identifier hs-type">Index</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="Text.Regex.TDFA.Common.html#TagCommand"><span class="hs-identifier hs-type">TagCommand</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-293"></a><span>        </span><a name="local-6989586621679054488"><a href="#local-6989586621679054488"><span class="hs-identifier">foo'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">IMap.toList</span><span>
</span><a name="line-294"></a><span class="hs-identifier">showQT</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Testing"><span class="hs-identifier hs-var">Testing</span></a><span> </span><a name="local-6989586621679054489"><a href="#local-6989586621679054489"><span class="hs-identifier">test</span></a></a><span> </span><a name="local-6989586621679054490"><a href="#local-6989586621679054490"><span class="hs-identifier">dopas</span></a></a><span> </span><a name="local-6989586621679054491"><a href="#local-6989586621679054491"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679054492"><a href="#local-6989586621679054492"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;{Testing &quot;</span><span class="hs-operator hs-var">++</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679054489"><span class="hs-identifier hs-var">test</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot; &quot;</span><span class="hs-operator hs-var">++</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.EnumSet2.html#toList"><span class="hs-identifier hs-var">Set.toList</span></a><span> </span><a href="#local-6989586621679054490"><span class="hs-identifier hs-var">dopas</span></a><span class="hs-special">)</span><span>
</span><a name="line-295"></a><span>                              </span><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;\n&quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679054493"><span class="hs-identifier hs-var">indent'</span></a><span> </span><a href="#local-6989586621679054491"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-296"></a><span>                              </span><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;\n&quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679054493"><span class="hs-identifier hs-var">indent'</span></a><span> </span><a href="#local-6989586621679054492"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;}&quot;</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679054493"><a href="#local-6989586621679054493"><span class="hs-identifier">indent'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054494"><span class="hs-identifier hs-var">spaces</span></a><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.Regex.TDFA.Common.html#showQT"><span class="hs-identifier hs-var">showQT</span></a><span>
</span><a name="line-298"></a><span>          </span><a name="local-6989586621679054494"><a href="#local-6989586621679054494"><span class="hs-identifier">spaces</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-char">' '</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-type">DT</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#showDT"><span class="hs-identifier hs-var">showDT</span></a><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-identifier">indent</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-303"></a><a name="indent"><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier">indent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679054650"><a href="#local-6989586621679054650"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-char">' '</span><span class="hs-glyph">:</span><span class="hs-char">' '</span><span class="hs-glyph">:</span><a href="#local-6989586621679054650"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-identifier">showDT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#DT"><span class="hs-identifier hs-type">DT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-306"></a><a name="showDT"><a href="Text.Regex.TDFA.Common.html#showDT"><span class="hs-identifier">showDT</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Simple%27"><span class="hs-identifier hs-var">Simple'</span></a><span> </span><a name="local-6989586621679054651"><a href="#local-6989586621679054651"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679054652"><a href="#local-6989586621679054652"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679054653"><a href="#local-6989586621679054653"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-307"></a><span>       </span><span class="hs-string">&quot;Simple' { dt_win = &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679054654"><span class="hs-identifier hs-var">seeWin1</span></a><span>
</span><a name="line-308"></a><span>  </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n        , dt_trans = &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679054655"><span class="hs-identifier hs-var">seeTrans1</span></a><span>
</span><a name="line-309"></a><span>  </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n        , dt_other = &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679054656"><span class="hs-identifier hs-var">seeOther1</span></a><span> </span><a href="#local-6989586621679054653"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-310"></a><span>  </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n        }&quot;</span><span>
</span><a name="line-311"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-312"></a><span>  </span><a name="local-6989586621679054654"><a href="#local-6989586621679054654"><span class="hs-identifier">seeWin1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">IMap.null</span><span> </span><a href="#local-6989586621679054651"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;No win&quot;</span><span>
</span><a name="line-313"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var">indent</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">IMap.assocs</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679054651"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span>  </span><span class="hs-identifier">seeTrans1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-316"></a><span>  </span><a name="local-6989586621679054655"><a href="#local-6989586621679054655"><span class="hs-identifier">seeTrans1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntMap.CharMap2.html#null"><span class="hs-identifier hs-var">Map.null</span></a><span> </span><a href="#local-6989586621679054652"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;No (Char,Transition)&quot;</span><span>
</span><a name="line-317"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var">indent</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-318"></a><span>     </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679054657"><a href="#local-6989586621679054657"><span class="hs-identifier">char</span></a></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-var">Transition</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">trans_many</span><span class="hs-glyph">=</span><a name="local-6989586621679054658"><a href="#local-6989586621679054658"><span class="hs-identifier">dfa</span></a></a><span class="hs-special">,</span><span class="hs-identifier">trans_single</span><span class="hs-glyph">=</span><a name="local-6989586621679054659"><a href="#local-6989586621679054659"><span class="hs-identifier">dfa2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">trans_how</span><span class="hs-glyph">=</span><a name="local-6989586621679054660"><a href="#local-6989586621679054660"><span class="hs-identifier">dtrans</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-319"></a><span>                           </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;(&quot;</span><span>
</span><a name="line-320"></a><span>                                  </span><span class="hs-special">,</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679054657"><span class="hs-identifier hs-var">char</span></a><span>
</span><a name="line-321"></a><span>                                  </span><span class="hs-special">,</span><span class="hs-string">&quot;, MANY &quot;</span><span>
</span><a name="line-322"></a><span>                                  </span><span class="hs-special">,</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d_id</span><span> </span><a href="#local-6989586621679054658"><span class="hs-identifier hs-var">dfa</span></a><span class="hs-special">)</span><span>
</span><a name="line-323"></a><span>                                  </span><span class="hs-special">,</span><span class="hs-string">&quot;, SINGLE &quot;</span><span>
</span><a name="line-324"></a><span>                                  </span><span class="hs-special">,</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d_id</span><span> </span><a href="#local-6989586621679054659"><span class="hs-identifier hs-var">dfa2</span></a><span class="hs-special">)</span><span>
</span><a name="line-325"></a><span>                                  </span><span class="hs-special">,</span><span class="hs-string">&quot;, \n&quot;</span><span>
</span><a name="line-326"></a><span>                                  </span><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#seeDTrans"><span class="hs-identifier hs-var">seeDTrans</span></a><span> </span><a href="#local-6989586621679054660"><span class="hs-identifier hs-var">dtrans</span></a><span>
</span><a name="line-327"></a><span>                                  </span><span class="hs-special">,</span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntMap.CharMap2.html#assocs"><span class="hs-identifier hs-var">Map.assocs</span></a><span> </span><a href="#local-6989586621679054652"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span>  </span><a name="local-6989586621679054656"><a href="#local-6989586621679054656"><span class="hs-identifier">seeOther1</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Transition"><span class="hs-identifier hs-var">Transition</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">trans_many</span><span class="hs-glyph">=</span><a name="local-6989586621679054661"><a href="#local-6989586621679054661"><span class="hs-identifier">dfa</span></a></a><span class="hs-special">,</span><span class="hs-identifier">trans_single</span><span class="hs-glyph">=</span><a name="local-6989586621679054662"><a href="#local-6989586621679054662"><span class="hs-identifier">dfa2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">trans_how</span><span class="hs-glyph">=</span><a name="local-6989586621679054663"><a href="#local-6989586621679054663"><span class="hs-identifier">dtrans</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-330"></a><span>    </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;(MANY &quot;</span><span>
</span><a name="line-331"></a><span>           </span><span class="hs-special">,</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d_id</span><span> </span><a href="#local-6989586621679054661"><span class="hs-identifier hs-var">dfa</span></a><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>           </span><span class="hs-special">,</span><span class="hs-string">&quot;, SINGLE &quot;</span><span>
</span><a name="line-333"></a><span>           </span><span class="hs-special">,</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d_id</span><span> </span><a href="#local-6989586621679054662"><span class="hs-identifier hs-var">dfa2</span></a><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>           </span><span class="hs-special">,</span><span class="hs-string">&quot;, \n&quot;</span><span>
</span><a name="line-335"></a><span>           </span><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#seeDTrans"><span class="hs-identifier hs-var">seeDTrans</span></a><span> </span><a href="#local-6989586621679054663"><span class="hs-identifier hs-var">dtrans</span></a><span>
</span><a name="line-336"></a><span>           </span><span class="hs-special">,</span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-identifier">showDT</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Testing%27"><span class="hs-identifier hs-var">Testing'</span></a><span> </span><a name="local-6989586621679054664"><a href="#local-6989586621679054664"><span class="hs-identifier">wt</span></a></a><span> </span><a name="local-6989586621679054665"><a href="#local-6989586621679054665"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679054666"><a href="#local-6989586621679054666"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679054667"><a href="#local-6989586621679054667"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Testing' { dt_test = &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679054664"><span class="hs-identifier hs-var">wt</span></a><span>
</span><a name="line-339"></a><span>                          </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n         , dt_dopas = &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679054665"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-340"></a><span>                          </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n         , dt_a = &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679054668"><span class="hs-identifier hs-var">indent'</span></a><span> </span><a href="#local-6989586621679054666"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-341"></a><span>                          </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n         , dt_b = &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679054668"><span class="hs-identifier hs-var">indent'</span></a><span> </span><a href="#local-6989586621679054667"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-342"></a><span>                          </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n         }&quot;</span><span>
</span><a name="line-343"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679054668"><a href="#local-6989586621679054668"><span class="hs-identifier">indent'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679054670"><a href="#local-6989586621679054670"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679054670"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-344"></a><span>                                           </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-345"></a><span>                                           </span><span class="hs-special">(</span><a name="local-6989586621679054671"><a href="#local-6989586621679054671"><span class="hs-identifier">h</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679054672"><a href="#local-6989586621679054672"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679054671"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054669"><span class="hs-identifier hs-var">spaces</span></a><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.Regex.TDFA.Common.html#showDT"><span class="hs-identifier hs-var">showDT</span></a><span>
</span><a name="line-346"></a><span>       </span><a name="local-6989586621679054669"><a href="#local-6989586621679054669"><span class="hs-identifier">spaces</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-char">' '</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-identifier">seeDTrans</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#DTrans"><span class="hs-identifier hs-type">DTrans</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-350"></a><span class="hs-comment">--seeDTrans x = concatMap (\(dest,y) -&gt; unlines . map (\(source,ins) -&gt; show (dest,source,ins) ) . IMap.assocs $ y) (IMap.assocs x)</span><span>
</span><a name="line-351"></a><a name="seeDTrans"><a href="Text.Regex.TDFA.Common.html#seeDTrans"><span class="hs-identifier">seeDTrans</span></a></a><span> </span><a name="local-6989586621679054673"><a href="#local-6989586621679054673"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">IMap.null</span><span> </span><a href="#local-6989586621679054673"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;No DTrans&quot;</span><span>
</span><a name="line-352"></a><span class="hs-identifier">seeDTrans</span><span> </span><a name="local-6989586621679054674"><a href="#local-6989586621679054674"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679054675"><span class="hs-identifier hs-var">seeSource</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IMap.assocs</span><span> </span><a href="#local-6989586621679054674"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679054675"><a href="#local-6989586621679054675"><span class="hs-identifier">seeSource</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679054676"><a href="#local-6989586621679054676"><span class="hs-identifier">dest</span></a></a><span class="hs-special">,</span><a name="local-6989586621679054677"><a href="#local-6989586621679054677"><span class="hs-identifier">srcMap</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">IMap.null</span><span> </span><a href="#local-6989586621679054677"><span class="hs-identifier hs-var">srcMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var">indent</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054676"><span class="hs-identifier hs-var">dest</span></a><span class="hs-special">,</span><span class="hs-string">&quot;SPAWN&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-354"></a><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#indent"><span class="hs-identifier hs-var">indent</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679054678"><a href="#local-6989586621679054678"><span class="hs-identifier">source</span></a></a><span class="hs-special">,</span><a name="local-6989586621679054679"><a href="#local-6989586621679054679"><span class="hs-identifier">ins</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054676"><span class="hs-identifier hs-var">dest</span></a><span class="hs-special">,</span><a href="#local-6989586621679054678"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">,</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">ins</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">IMap.assocs</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679054677"><span class="hs-identifier hs-var">srcMap</span></a><span>
</span><a name="line-355"></a><span class="hs-comment">--        spawnIns = Instructions { newPos = [(0,SetPost)], newOrbits = Nothing }</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Text.Regex.TDFA.Common.html#QT"><span class="hs-identifier hs-type">QT</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-359"></a><span>  </span><a name="local-6989586621679054394"><a href="#local-6989586621679054394"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Testing"><span class="hs-identifier hs-var">Testing</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679054395"><a href="#local-6989586621679054395"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Testing"><span class="hs-identifier hs-var">Testing</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-360"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">qt_test</span><span> </span><a href="#local-6989586621679054394"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">qt_test</span><span> </span><a href="#local-6989586621679054395"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">qt_a</span><span> </span><a href="#local-6989586621679054394"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">qt_a</span><span> </span><a href="#local-6989586621679054395"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">qt_b</span><span> </span><a href="#local-6989586621679054394"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">qt_b</span><span> </span><a href="#local-6989586621679054395"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>  </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Simple"><span class="hs-identifier hs-var">Simple</span></a><span> </span><a name="local-6989586621679054396"><a href="#local-6989586621679054396"><span class="hs-identifier">w1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-var">CharMap</span></a><span> </span><a name="local-6989586621679054397"><a href="#local-6989586621679054397"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679054398"><a href="#local-6989586621679054398"><span class="hs-identifier">o1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#Simple"><span class="hs-identifier hs-var">Simple</span></a><span> </span><a name="local-6989586621679054399"><a href="#local-6989586621679054399"><span class="hs-identifier">w2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntMap.CharMap2.html#CharMap"><span class="hs-identifier hs-var">CharMap</span></a><span> </span><a name="local-6989586621679054400"><a href="#local-6989586621679054400"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679054401"><a href="#local-6989586621679054401"><span class="hs-identifier">o2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-362"></a><span>    </span><a href="#local-6989586621679054396"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679054399"><span class="hs-identifier hs-var">w2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679054402"><span class="hs-identifier hs-var">eqTrans</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679054403"><span class="hs-identifier hs-var">eqQTrans</span></a><span> </span><a href="#local-6989586621679054398"><span class="hs-identifier hs-var">o1</span></a><span> </span><a href="#local-6989586621679054401"><span class="hs-identifier hs-var">o2</span></a><span>
</span><a name="line-363"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">eqTrans</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-364"></a><span>          </span><a name="local-6989586621679054402"><a href="#local-6989586621679054402"><span class="hs-identifier">eqTrans</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IMap.size</span><span> </span><a href="#local-6989586621679054397"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">IMap.size</span><span> </span><a href="#local-6989586621679054400"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>                    </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679054404"><span class="hs-identifier hs-var">together</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IMap.toAscList</span><span> </span><a href="#local-6989586621679054397"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IMap.toAscList</span><span> </span><a href="#local-6989586621679054400"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679054404"><a href="#local-6989586621679054404"><span class="hs-identifier">together</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679054405"><a href="#local-6989586621679054405"><span class="hs-identifier">c1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679054406"><a href="#local-6989586621679054406"><span class="hs-identifier">qtrans1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679054407"><a href="#local-6989586621679054407"><span class="hs-identifier">c2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679054408"><a href="#local-6989586621679054408"><span class="hs-identifier">qtrans2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679054405"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679054407"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679054403"><span class="hs-identifier hs-var">eqQTrans</span></a><span> </span><a href="#local-6989586621679054406"><span class="hs-identifier hs-var">qtrans1</span></a><span> </span><a href="#local-6989586621679054408"><span class="hs-identifier hs-var">qtrans2</span></a><span>
</span><a name="line-367"></a><span>          </span><span class="hs-identifier">eqQTrans</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.Regex.TDFA.Common.html#QTrans"><span class="hs-identifier hs-type">QTrans</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-368"></a><span>          </span><a name="local-6989586621679054403"><a href="#local-6989586621679054403"><span class="hs-identifier">eqQTrans</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-370"></a></pre></body></html>