<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-cpp">#include &quot;boxes.h&quot;
</span><span>
</span><a name="line-4"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Module      :  Text.PrettyPrint.Boxes</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Copyright   :  (c) Brent Yorgey 2009</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Maintainer  :  David.Feuer@gmail.com</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- A pretty-printing library for laying out text in two dimensions,</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- using a simple box model.</span><span>
</span><a name="line-15"></a><span class="hs-comment">--</span><span>
</span><a name="line-16"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-17"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.PrettyPrint.Boxes</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * Constructing boxes</span><span>
</span><a name="line-19"></a><span class="hs-cpp">#ifdef TESTING
</span><span>      </span><span class="hs-identifier">Box</span><span class="hs-special">(</span><span class="hs-identifier">Box</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">content</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-cpp">#else
</span><span>      </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-23"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#nullBox"><span class="hs-identifier hs-var">nullBox</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#emptyBox"><span class="hs-identifier hs-var">emptyBox</span></a><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#char"><span class="hs-identifier hs-var">char</span></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#text"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#para"><span class="hs-identifier hs-var">para</span></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#columns"><span class="hs-identifier hs-var">columns</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>      </span><span class="hs-comment">-- * Layout of boxes</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#hcat"><span class="hs-identifier hs-var">hcat</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#%2F%2F"><span class="hs-operator hs-var">//</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#%2F%2B%2F"><span class="hs-operator hs-var">/+/</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#vsep"><span class="hs-identifier hs-var">vsep</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#punctuateH"><span class="hs-identifier hs-var">punctuateH</span></a><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#punctuateV"><span class="hs-identifier hs-var">punctuateV</span></a><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-comment">-- * Alignment</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Alignment</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span>
</span><a name="line-51"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-53"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Content</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#left"><span class="hs-identifier hs-var">left</span></a><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#right"><span class="hs-identifier hs-var">right</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#top"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#bottom"><span class="hs-identifier hs-var">bottom</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#center1"><span class="hs-identifier hs-var">center1</span></a><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#center2"><span class="hs-identifier hs-var">center2</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#moveLeft"><span class="hs-identifier hs-var">moveLeft</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#moveRight"><span class="hs-identifier hs-var">moveRight</span></a><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#moveUp"><span class="hs-identifier hs-var">moveUp</span></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#moveDown"><span class="hs-identifier hs-var">moveDown</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#alignHoriz"><span class="hs-identifier hs-var">alignHoriz</span></a><span>
</span><a name="line-66"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#alignVert"><span class="hs-identifier hs-var">alignVert</span></a><span>
</span><a name="line-67"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#align"><span class="hs-identifier hs-var">align</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-comment">-- * Inspecting boxes</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#rows"><span class="hs-identifier hs-var">rows</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#cols"><span class="hs-identifier hs-var">cols</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-comment">-- * Rendering boxes</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#render"><span class="hs-identifier hs-var">render</span></a><span>
</span><a name="line-77"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#printBox"><span class="hs-identifier hs-var">printBox</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-cpp">#if MIN_VERSION_base(4,11,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span class="hs-cpp">#elif MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldr</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldr</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toList</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-cpp">#if MIN_VERSION_base(4,4,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">words</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unwords</span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">words</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">unwords</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-97"></a><span class="hs-cpp">#ifdef OVERLOADED_STRINGS
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">***</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">first</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">intersperse</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">chunksOf</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | The basic data type.  A box has a specified size and some sort of</span><span>
</span><a name="line-107"></a><span class="hs-comment">--   contents.</span><span>
</span><a name="line-108"></a><span class="hs-keyword">data</span><span> </span><a name="Box"><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier">Box</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Box"><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier">Box</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="rows"><a href="Text.PrettyPrint.Boxes.html#rows"><span class="hs-identifier">rows</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-109"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="cols"><a href="Text.PrettyPrint.Boxes.html#cols"><span class="hs-identifier">cols</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-110"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="content"><a href="Text.PrettyPrint.Boxes.html#content"><span class="hs-identifier">content</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Content"><span class="hs-identifier hs-type">Content</span></a><span>
</span><a name="line-111"></a><span>               </span><span class="hs-special">}</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-cpp">#ifdef OVERLOADED_STRINGS
</span><span class="hs-comment">-- | Convenient ability to use bare string literals as boxes.</span><span>
</span><a name="line-116"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>  </span><a name="local-3458764513820541114"><span class="hs-identifier">fromString</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#text"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-118"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- | Data type for specifying the alignment of boxes.</span><span>
</span><a name="line-121"></a><span class="hs-keyword">data</span><span> </span><a name="Alignment"><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier">Alignment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AlignFirst"><a href="Text.PrettyPrint.Boxes.html#AlignFirst"><span class="hs-identifier">AlignFirst</span></a></a><span>    </span><span class="hs-comment">-- ^ Align at the top/left.</span><span>
</span><a name="line-122"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="AlignCenter1"><a href="Text.PrettyPrint.Boxes.html#AlignCenter1"><span class="hs-identifier">AlignCenter1</span></a></a><span>  </span><span class="hs-comment">-- ^ Centered, biased to the top/left.</span><span>
</span><a name="line-123"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="AlignCenter2"><a href="Text.PrettyPrint.Boxes.html#AlignCenter2"><span class="hs-identifier">AlignCenter2</span></a></a><span>  </span><span class="hs-comment">-- ^ Centered, biased to the bottom/right.</span><span>
</span><a name="line-124"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="AlignLast"><a href="Text.PrettyPrint.Boxes.html#AlignLast"><span class="hs-identifier">AlignLast</span></a></a><span>     </span><span class="hs-comment">-- ^ Align at the bottom/right.</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">-- | Align boxes along their tops.</span><span>
</span><a name="line-128"></a><span class="hs-identifier">top</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span>
</span><a name="line-129"></a><a name="top"><a href="Text.PrettyPrint.Boxes.html#top"><span class="hs-identifier">top</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignFirst"><span class="hs-identifier hs-var">AlignFirst</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- | Align boxes along their bottoms.</span><span>
</span><a name="line-132"></a><span class="hs-identifier">bottom</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span>
</span><a name="line-133"></a><a name="bottom"><a href="Text.PrettyPrint.Boxes.html#bottom"><span class="hs-identifier">bottom</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignLast"><span class="hs-identifier hs-var">AlignLast</span></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- | Align boxes to the left.</span><span>
</span><a name="line-136"></a><span class="hs-identifier">left</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span>
</span><a name="line-137"></a><a name="left"><a href="Text.PrettyPrint.Boxes.html#left"><span class="hs-identifier">left</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignFirst"><span class="hs-identifier hs-var">AlignFirst</span></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | Align boxes to the right.</span><span>
</span><a name="line-140"></a><span class="hs-identifier">right</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span>
</span><a name="line-141"></a><a name="right"><a href="Text.PrettyPrint.Boxes.html#right"><span class="hs-identifier">right</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignLast"><span class="hs-identifier hs-var">AlignLast</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- | Align boxes centered, but biased to the left/top in case of</span><span>
</span><a name="line-144"></a><span class="hs-comment">--   unequal parities.</span><span>
</span><a name="line-145"></a><span class="hs-identifier">center1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span>
</span><a name="line-146"></a><a name="center1"><a href="Text.PrettyPrint.Boxes.html#center1"><span class="hs-identifier">center1</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignCenter1"><span class="hs-identifier hs-var">AlignCenter1</span></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- | Align boxes centered, but biased to the right/bottom in case of</span><span>
</span><a name="line-149"></a><span class="hs-comment">--   unequal parities.</span><span>
</span><a name="line-150"></a><span class="hs-identifier">center2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span>
</span><a name="line-151"></a><a name="center2"><a href="Text.PrettyPrint.Boxes.html#center2"><span class="hs-identifier">center2</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignCenter2"><span class="hs-identifier hs-var">AlignCenter2</span></a><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- | Contents of a box.</span><span>
</span><a name="line-154"></a><span class="hs-keyword">data</span><span> </span><a name="Content"><a href="Text.PrettyPrint.Boxes.html#Content"><span class="hs-identifier">Content</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Blank"><a href="Text.PrettyPrint.Boxes.html#Blank"><span class="hs-identifier">Blank</span></a></a><span>        </span><span class="hs-comment">-- ^ No content.</span><span>
</span><a name="line-155"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="Text"><a href="Text.PrettyPrint.Boxes.html#Text"><span class="hs-identifier">Text</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span>  </span><span class="hs-comment">-- ^ A raw string.</span><span>
</span><a name="line-156"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="Row"><a href="Text.PrettyPrint.Boxes.html#Row"><span class="hs-identifier">Row</span></a></a><span> </span><span class="hs-special">[</span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- ^ A row of sub-boxes.</span><span>
</span><a name="line-157"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="Col"><a href="Text.PrettyPrint.Boxes.html#Col"><span class="hs-identifier">Col</span></a></a><span> </span><span class="hs-special">[</span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- ^ A column of sub-boxes.</span><span>
</span><a name="line-158"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="SubBox"><a href="Text.PrettyPrint.Boxes.html#SubBox"><span class="hs-identifier">SubBox</span></a></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-159"></a><span>                            </span><span class="hs-comment">-- ^ A sub-box with a specified alignment.</span><span>
</span><a name="line-160"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">-- | The null box, which has no content and no size.  It is quite</span><span>
</span><a name="line-163"></a><span class="hs-comment">--   useless.</span><span>
</span><a name="line-164"></a><span class="hs-identifier">nullBox</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-165"></a><a name="nullBox"><a href="Text.PrettyPrint.Boxes.html#nullBox"><span class="hs-identifier">nullBox</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#emptyBox"><span class="hs-identifier hs-var">emptyBox</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | @emptyBox r c@ is an empty box with @r@ rows and @c@ columns.</span><span>
</span><a name="line-168"></a><span class="hs-comment">--   Useful for effecting more fine-grained positioning of other</span><span>
</span><a name="line-169"></a><span class="hs-comment">--   boxes, by inserting empty boxes of the desired size in between</span><span>
</span><a name="line-170"></a><span class="hs-comment">--   them.</span><span>
</span><a name="line-171"></a><span class="hs-identifier">emptyBox</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-172"></a><a name="emptyBox"><a href="Text.PrettyPrint.Boxes.html#emptyBox"><span class="hs-identifier">emptyBox</span></a></a><span> </span><a name="local-6989586621679026804"><a href="#local-6989586621679026804"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679026805"><a href="#local-6989586621679026805"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a href="#local-6989586621679026804"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679026805"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Blank"><span class="hs-identifier hs-var">Blank</span></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-comment">-- | A @1x1@ box containing a single character.</span><span>
</span><a name="line-175"></a><span class="hs-identifier">char</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-176"></a><a name="char"><a href="Text.PrettyPrint.Boxes.html#char"><span class="hs-identifier">char</span></a></a><span> </span><a name="local-6989586621679026806"><a href="#local-6989586621679026806"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Text"><span class="hs-identifier hs-var">Text</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026806"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- | A (@1 x len@) box containing a string of length @len@.</span><span>
</span><a name="line-179"></a><span class="hs-identifier">text</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-180"></a><a name="text"><a href="Text.PrettyPrint.Boxes.html#text"><span class="hs-identifier">text</span></a></a><span> </span><a name="local-6989586621679026807"><a href="#local-6989586621679026807"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679026807"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Text"><span class="hs-identifier hs-var">Text</span></a><span> </span><a href="#local-6989586621679026807"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-comment">-- | Paste two boxes together horizontally, using a default (top)</span><span>
</span><a name="line-183"></a><span class="hs-comment">--   alignment.</span><span>
</span><a name="line-184"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-185"></a><a name="local-6989586621679026808"><a href="#local-6989586621679026808"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3E"><a href="Text.PrettyPrint.Boxes.html#%3C%3E"><span class="hs-operator">&lt;&gt;</span></a></a><span> </span><a name="local-6989586621679026809"><a href="#local-6989586621679026809"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#hcat"><span class="hs-identifier hs-var">hcat</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#top"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026808"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><a href="#local-6989586621679026809"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-comment">-- | Paste two boxes together horizontally with a single intervening</span><span>
</span><a name="line-188"></a><span class="hs-comment">--   column of space, using a default (top) alignment.</span><span>
</span><a name="line-189"></a><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-190"></a><a name="local-6989586621679026810"><a href="#local-6989586621679026810"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%2B%3E"><a href="Text.PrettyPrint.Boxes.html#%3C%2B%3E"><span class="hs-operator">&lt;+&gt;</span></a></a><span> </span><a name="local-6989586621679026811"><a href="#local-6989586621679026811"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#hcat"><span class="hs-identifier hs-var">hcat</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#top"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026810"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#emptyBox"><span class="hs-identifier hs-var">emptyBox</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026811"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">-- | Paste two boxes together vertically, using a default (left)</span><span>
</span><a name="line-193"></a><span class="hs-comment">--   alignment.</span><span>
</span><a name="line-194"></a><span class="hs-special">(</span><span class="hs-operator">//</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-195"></a><a name="local-6989586621679026812"><a href="#local-6989586621679026812"><span class="hs-identifier">t</span></a></a><span> </span><a name="%2F%2F"><a href="Text.PrettyPrint.Boxes.html#%2F%2F"><span class="hs-operator">//</span></a></a><span> </span><a name="local-6989586621679026813"><a href="#local-6989586621679026813"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#left"><span class="hs-identifier hs-var">left</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026812"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><a href="#local-6989586621679026813"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- | Paste two boxes together vertically with a single intervening row</span><span>
</span><a name="line-198"></a><span class="hs-comment">--   of space, using a default (left) alignment.</span><span>
</span><a name="line-199"></a><span class="hs-special">(</span><span class="hs-operator">/+/</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-200"></a><a name="local-6989586621679026814"><a href="#local-6989586621679026814"><span class="hs-identifier">t</span></a></a><span> </span><a name="%2F%2B%2F"><a href="Text.PrettyPrint.Boxes.html#%2F%2B%2F"><span class="hs-operator">/+/</span></a></a><span> </span><a name="local-6989586621679026815"><a href="#local-6989586621679026815"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#left"><span class="hs-identifier hs-var">left</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026814"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="Text.PrettyPrint.Boxes.html#emptyBox"><span class="hs-identifier hs-var">emptyBox</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026815"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-comment">-- | Glue a list of boxes together horizontally, with the given alignment.</span><span>
</span><a name="line-203"></a><span class="hs-identifier">hcat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026803"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026803"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-204"></a><a name="hcat"><a href="Text.PrettyPrint.Boxes.html#hcat"><span class="hs-identifier">hcat</span></a></a><span> </span><a name="local-6989586621679026816"><a href="#local-6989586621679026816"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679026817"><a href="#local-6989586621679026817"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a href="#local-6989586621679026819"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679026818"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Row"><span class="hs-identifier hs-var">Row</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#alignVert"><span class="hs-identifier hs-var">alignVert</span></a><span> </span><a href="#local-6989586621679026816"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679026819"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026820"><span class="hs-identifier hs-var">bsl</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-206"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679026818"><a href="#local-6989586621679026818"><span class="hs-identifier">w</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679026819"><a href="#local-6989586621679026819"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#sumMax"><span class="hs-identifier hs-var">sumMax</span></a><span> </span><span class="hs-identifier">cols</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">rows</span><span> </span><a href="#local-6989586621679026820"><span class="hs-identifier hs-var">bsl</span></a><span>
</span><a name="line-207"></a><span>    </span><a name="local-6989586621679026820"><a href="#local-6989586621679026820"><span class="hs-identifier">bsl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toList</span><span> </span><a href="#local-6989586621679026817"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- | @hsep sep a bs@ lays out @bs@ horizontally with alignment @a@,</span><span>
</span><a name="line-210"></a><span class="hs-comment">--   with @sep@ amount of space in between each.</span><span>
</span><a name="line-211"></a><span class="hs-identifier">hsep</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026802"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026802"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-212"></a><a name="hsep"><a href="Text.PrettyPrint.Boxes.html#hsep"><span class="hs-identifier">hsep</span></a></a><span> </span><a name="local-6989586621679026821"><a href="#local-6989586621679026821"><span class="hs-identifier">sep</span></a></a><span> </span><a name="local-6989586621679026822"><a href="#local-6989586621679026822"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679026823"><a href="#local-6989586621679026823"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#punctuateH"><span class="hs-identifier hs-var">punctuateH</span></a><span> </span><a href="#local-6989586621679026822"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#emptyBox"><span class="hs-identifier hs-var">emptyBox</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679026821"><span class="hs-identifier hs-var">sep</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026823"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">-- | Glue a list of boxes together vertically, with the given alignment.</span><span>
</span><a name="line-215"></a><span class="hs-identifier">vcat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026801"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026801"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-216"></a><a name="vcat"><a href="Text.PrettyPrint.Boxes.html#vcat"><span class="hs-identifier">vcat</span></a></a><span> </span><a name="local-6989586621679026824"><a href="#local-6989586621679026824"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679026825"><a href="#local-6989586621679026825"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a href="#local-6989586621679026826"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679026827"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Col"><span class="hs-identifier hs-var">Col</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#alignHoriz"><span class="hs-identifier hs-var">alignHoriz</span></a><span> </span><a href="#local-6989586621679026824"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679026827"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026828"><span class="hs-identifier hs-var">bsl</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-218"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679026826"><a href="#local-6989586621679026826"><span class="hs-identifier">h</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679026827"><a href="#local-6989586621679026827"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#sumMax"><span class="hs-identifier hs-var">sumMax</span></a><span> </span><span class="hs-identifier">rows</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">cols</span><span> </span><a href="#local-6989586621679026828"><span class="hs-identifier hs-var">bsl</span></a><span>
</span><a name="line-219"></a><span>    </span><a name="local-6989586621679026828"><a href="#local-6989586621679026828"><span class="hs-identifier">bsl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toList</span><span> </span><a href="#local-6989586621679026825"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-comment">-- Calculate a sum and a maximum over a list in one pass. If the list is</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- empty, the maximum is reported as the given default. This would</span><span>
</span><a name="line-223"></a><span class="hs-comment">-- normally be done using the foldl library, but we don't want that</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- dependency.</span><span>
</span><a name="line-225"></a><span class="hs-identifier">sumMax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679026717"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679026718"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026719"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026720"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026717"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026718"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026720"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026718"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026719"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679026720"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026717"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026718"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><a name="sumMax"><a href="Text.PrettyPrint.Boxes.html#sumMax"><span class="hs-identifier">sumMax</span></a></a><span> </span><a name="local-6989586621679026829"><a href="#local-6989586621679026829"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679026830"><a href="#local-6989586621679026830"><span class="hs-identifier">defaultMax</span></a></a><span> </span><a name="local-6989586621679026831"><a href="#local-6989586621679026831"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679026833"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679026830"><span class="hs-identifier hs-var">defaultMax</span></a><span>
</span><a name="line-227"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-228"></a><span>    </span><a name="local-6989586621679026833"><a href="#local-6989586621679026833"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679026834"><a href="#local-6989586621679026834"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679026835"><a href="#local-6989586621679026835"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679026836"><a href="#local-6989586621679026836"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679026837"><a href="#local-6989586621679026837"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026835"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679026829"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679026834"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679026836"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679026831"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679026834"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">max</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679026837"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">-- | @vsep sep a bs@ lays out @bs@ vertically with alignment @a@,</span><span>
</span><a name="line-231"></a><span class="hs-comment">--   with @sep@ amount of space in between each.</span><span>
</span><a name="line-232"></a><span class="hs-identifier">vsep</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026716"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026716"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-233"></a><a name="vsep"><a href="Text.PrettyPrint.Boxes.html#vsep"><span class="hs-identifier">vsep</span></a></a><span> </span><a name="local-6989586621679026838"><a href="#local-6989586621679026838"><span class="hs-identifier">sep</span></a></a><span> </span><a name="local-6989586621679026839"><a href="#local-6989586621679026839"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679026840"><a href="#local-6989586621679026840"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#punctuateV"><span class="hs-identifier hs-var">punctuateV</span></a><span> </span><a href="#local-6989586621679026839"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#emptyBox"><span class="hs-identifier hs-var">emptyBox</span></a><span> </span><a href="#local-6989586621679026838"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toList</span><span> </span><a href="#local-6989586621679026840"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- | @punctuateH a p bs@ horizontally lays out the boxes @bs@ with a</span><span>
</span><a name="line-236"></a><span class="hs-comment">--   copy of @p@ interspersed between each.</span><span>
</span><a name="line-237"></a><span class="hs-identifier">punctuateH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026715"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026715"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-238"></a><a name="punctuateH"><a href="Text.PrettyPrint.Boxes.html#punctuateH"><span class="hs-identifier">punctuateH</span></a></a><span> </span><a name="local-6989586621679026841"><a href="#local-6989586621679026841"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679026842"><a href="#local-6989586621679026842"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679026843"><a href="#local-6989586621679026843"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#hcat"><span class="hs-identifier hs-var">hcat</span></a><span> </span><a href="#local-6989586621679026841"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intersperse</span><span> </span><a href="#local-6989586621679026842"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toList</span><span> </span><a href="#local-6989586621679026843"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- | A vertical version of 'punctuateH'.</span><span>
</span><a name="line-241"></a><span class="hs-identifier">punctuateV</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026714"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026714"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-242"></a><a name="punctuateV"><a href="Text.PrettyPrint.Boxes.html#punctuateV"><span class="hs-identifier">punctuateV</span></a></a><span> </span><a name="local-6989586621679027003"><a href="#local-6989586621679027003"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679027004"><a href="#local-6989586621679027004"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679027005"><a href="#local-6989586621679027005"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621679027003"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intersperse</span><span> </span><a href="#local-6989586621679027004"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toList</span><span> </span><a href="#local-6989586621679027005"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-245"></a><span class="hs-comment">--  Paragraph flowing  ---------------------------------------------------------</span><span>
</span><a name="line-246"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-comment">-- | @para algn w t@ is a box of width @w@, containing text @t@,</span><span>
</span><a name="line-249"></a><span class="hs-comment">--   aligned according to @algn@, flowed to fit within the given</span><span>
</span><a name="line-250"></a><span class="hs-comment">--   width.</span><span>
</span><a name="line-251"></a><span class="hs-identifier">para</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-252"></a><a name="para"><a href="Text.PrettyPrint.Boxes.html#para"><span class="hs-identifier">para</span></a></a><span> </span><a name="local-6989586621679027006"><a href="#local-6989586621679027006"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679027007"><a href="#local-6989586621679027007"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679027008"><a href="#local-6989586621679027008"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679027009"><a href="#local-6989586621679027009"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#mkParaBox"><span class="hs-identifier hs-var">mkParaBox</span></a><span> </span><a href="#local-6989586621679027006"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679027009"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027009"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Text.PrettyPrint.Boxes.html#flow"><span class="hs-identifier hs-var">flow</span></a><span> </span><a href="#local-6989586621679027007"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679027008"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-comment">-- | @columns w h t@ is a list of boxes, each of width @w@ and height</span><span>
</span><a name="line-255"></a><span class="hs-comment">--   at most @h@, containing text @t@ flowed into as many columns as</span><span>
</span><a name="line-256"></a><span class="hs-comment">--   necessary.</span><span>
</span><a name="line-257"></a><span class="hs-identifier">columns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span class="hs-special">]</span><span>
</span><a name="line-258"></a><a name="columns"><a href="Text.PrettyPrint.Boxes.html#columns"><span class="hs-identifier">columns</span></a></a><span> </span><a name="local-6989586621679027010"><a href="#local-6989586621679027010"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679027011"><a href="#local-6989586621679027011"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679027012"><a href="#local-6989586621679027012"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679027013"><a href="#local-6989586621679027013"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#mkParaBox"><span class="hs-identifier hs-var">mkParaBox</span></a><span> </span><a href="#local-6989586621679027010"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679027012"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">chunksOf</span><span> </span><a href="#local-6989586621679027012"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Text.PrettyPrint.Boxes.html#flow"><span class="hs-identifier hs-var">flow</span></a><span> </span><a href="#local-6989586621679027011"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679027013"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">-- | @mkParaBox a n s@ makes a box of height @n@ with the text @s@</span><span>
</span><a name="line-261"></a><span class="hs-comment">--   aligned according to @a@.</span><span>
</span><a name="line-262"></a><span class="hs-identifier">mkParaBox</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-263"></a><a name="mkParaBox"><a href="Text.PrettyPrint.Boxes.html#mkParaBox"><span class="hs-identifier">mkParaBox</span></a></a><span> </span><a name="local-6989586621679027365"><a href="#local-6989586621679027365"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679027366"><a href="#local-6989586621679027366"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#alignVert"><span class="hs-identifier hs-var">alignVert</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#top"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679027366"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.PrettyPrint.Boxes.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="#local-6989586621679027365"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Text.PrettyPrint.Boxes.html#text"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">-- | Flow the given text into the given width.</span><span>
</span><a name="line-266"></a><span class="hs-identifier">flow</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-267"></a><a name="flow"><a href="Text.PrettyPrint.Boxes.html#flow"><span class="hs-identifier">flow</span></a></a><span> </span><a name="local-6989586621679027367"><a href="#local-6989586621679027367"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679027368"><a href="#local-6989586621679027368"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679027367"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>         </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.PrettyPrint.Boxes.html#getLines"><span class="hs-identifier hs-var">getLines</span></a><span>
</span><a name="line-269"></a><span>         </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="Text.PrettyPrint.Boxes.html#addWordP"><span class="hs-identifier hs-var">addWordP</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#emptyPara"><span class="hs-identifier hs-var">emptyPara</span></a><span> </span><a href="#local-6989586621679027367"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Text.PrettyPrint.Boxes.html#mkWord"><span class="hs-identifier hs-var">mkWord</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">words</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679027368"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-keyword">data</span><span> </span><a name="Para"><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier">Para</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Para"><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier">Para</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="paraWidth"><a href="Text.PrettyPrint.Boxes.html#paraWidth"><span class="hs-identifier">paraWidth</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-272"></a><span>                 </span><span class="hs-special">,</span><span> </span><a name="paraContent"><a href="Text.PrettyPrint.Boxes.html#paraContent"><span class="hs-identifier">paraContent</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#ParaContent"><span class="hs-identifier hs-type">ParaContent</span></a><span>
</span><a name="line-273"></a><span>                 </span><span class="hs-special">}</span><span>
</span><a name="line-274"></a><span class="hs-keyword">data</span><span> </span><a name="ParaContent"><a href="Text.PrettyPrint.Boxes.html#ParaContent"><span class="hs-identifier">ParaContent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Block"><a href="Text.PrettyPrint.Boxes.html#Block"><span class="hs-identifier">Block</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="fullLines"><a href="Text.PrettyPrint.Boxes.html#fullLines"><span class="hs-identifier">fullLines</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-type">Line</span></a><span class="hs-special">]</span><span>
</span><a name="line-275"></a><span>                         </span><span class="hs-special">,</span><span> </span><a name="lastLine"><a href="Text.PrettyPrint.Boxes.html#lastLine"><span class="hs-identifier">lastLine</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-type">Line</span></a><span>
</span><a name="line-276"></a><span>                         </span><span class="hs-special">}</span><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-identifier">emptyPara</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-type">Para</span></a><span>
</span><a name="line-279"></a><a name="emptyPara"><a href="Text.PrettyPrint.Boxes.html#emptyPara"><span class="hs-identifier">emptyPara</span></a></a><span> </span><a name="local-6989586621679027558"><a href="#local-6989586621679027558"><span class="hs-identifier">pw</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-var">Para</span></a><span> </span><a href="#local-6989586621679027558"><span class="hs-identifier hs-var">pw</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Block"><span class="hs-identifier hs-var">Block</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-var">Line</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span class="hs-identifier">getLines</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-type">Para</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-282"></a><a name="getLines"><a href="Text.PrettyPrint.Boxes.html#getLines"><span class="hs-identifier">getLines</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-var">Para</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Block"><span class="hs-identifier hs-var">Block</span></a><span> </span><a name="local-6989586621679027559"><a href="#local-6989586621679027559"><span class="hs-identifier">ls</span></a></a><span> </span><a name="local-6989586621679027560"><a href="#local-6989586621679027560"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">lLen</span><span> </span><a href="#local-6989586621679027560"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679027561"><span class="hs-identifier hs-var">process</span></a><span> </span><a href="#local-6989586621679027559"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-284"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679027561"><span class="hs-identifier hs-var">process</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027560"><span class="hs-identifier hs-var">l</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679027559"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679027561"><a href="#local-6989586621679027561"><span class="hs-identifier">process</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">getWord</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getWords</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-keyword">data</span><span> </span><a name="Line"><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier">Line</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Line"><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier">Line</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="lLen"><a href="Text.PrettyPrint.Boxes.html#lLen"><span class="hs-identifier">lLen</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a name="getWords"><a href="Text.PrettyPrint.Boxes.html#getWords"><span class="hs-identifier">getWords</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-identifier">mkLine</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-type">Line</span></a><span>
</span><a name="line-290"></a><a name="mkLine"><a href="Text.PrettyPrint.Boxes.html#mkLine"><span class="hs-identifier">mkLine</span></a></a><span> </span><a name="local-6989586621679027562"><a href="#local-6989586621679027562"><span class="hs-identifier">ws</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-var">Line</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">wLen</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027562"><span class="hs-identifier hs-var">ws</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027562"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span class="hs-identifier">startLine</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier hs-type">Word</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-type">Line</span></a><span>
</span><a name="line-293"></a><a name="startLine"><a href="Text.PrettyPrint.Boxes.html#startLine"><span class="hs-identifier">startLine</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#mkLine"><span class="hs-identifier hs-var">mkLine</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-keyword">data</span><span> </span><a name="Word"><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier">Word</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Word"><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier">Word</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="wLen"><a href="Text.PrettyPrint.Boxes.html#wLen"><span class="hs-identifier">wLen</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a name="getWord"><a href="Text.PrettyPrint.Boxes.html#getWord"><span class="hs-identifier">getWord</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-identifier">mkWord</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier hs-type">Word</span></a><span>
</span><a name="line-298"></a><a name="mkWord"><a href="Text.PrettyPrint.Boxes.html#mkWord"><span class="hs-identifier">mkWord</span></a></a><span> </span><a name="local-6989586621679027563"><a href="#local-6989586621679027563"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier hs-var">Word</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679027563"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027563"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-identifier">addWordP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-type">Para</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier hs-type">Word</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-type">Para</span></a><span>
</span><a name="line-301"></a><a name="addWordP"><a href="Text.PrettyPrint.Boxes.html#addWordP"><span class="hs-identifier">addWordP</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-var">Para</span></a><span> </span><a name="local-6989586621679027564"><a href="#local-6989586621679027564"><span class="hs-identifier">pw</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Block"><span class="hs-identifier hs-var">Block</span></a><span> </span><a name="local-6989586621679027565"><a href="#local-6989586621679027565"><span class="hs-identifier">fl</span></a></a><span> </span><a name="local-6989586621679027566"><a href="#local-6989586621679027566"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679027567"><a href="#local-6989586621679027567"><span class="hs-identifier">w</span></a></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Text.PrettyPrint.Boxes.html#wordFits"><span class="hs-identifier hs-var">wordFits</span></a><span> </span><a href="#local-6989586621679027564"><span class="hs-identifier hs-var">pw</span></a><span> </span><a href="#local-6989586621679027567"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679027566"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-var">Para</span></a><span> </span><a href="#local-6989586621679027564"><span class="hs-identifier hs-var">pw</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Block"><span class="hs-identifier hs-var">Block</span></a><span> </span><a href="#local-6989586621679027565"><span class="hs-identifier hs-var">fl</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#addWordL"><span class="hs-identifier hs-var">addWordL</span></a><span> </span><a href="#local-6989586621679027567"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679027566"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Para"><span class="hs-identifier hs-var">Para</span></a><span> </span><a href="#local-6989586621679027564"><span class="hs-identifier hs-var">pw</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Block"><span class="hs-identifier hs-var">Block</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027566"><span class="hs-identifier hs-var">l</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679027565"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#startLine"><span class="hs-identifier hs-var">startLine</span></a><span> </span><a href="#local-6989586621679027567"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-identifier">addWordL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier hs-type">Word</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-type">Line</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-type">Line</span></a><span>
</span><a name="line-306"></a><a name="addWordL"><a href="Text.PrettyPrint.Boxes.html#addWordL"><span class="hs-identifier">addWordL</span></a></a><span> </span><a name="local-6989586621679027568"><a href="#local-6989586621679027568"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-var">Line</span></a><span> </span><a name="local-6989586621679027569"><a href="#local-6989586621679027569"><span class="hs-identifier">len</span></a></a><span> </span><a name="local-6989586621679027570"><a href="#local-6989586621679027570"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-var">Line</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027569"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">wLen</span><span> </span><a href="#local-6989586621679027568"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027568"><span class="hs-identifier hs-var">w</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679027570"><span class="hs-identifier hs-var">ws</span></a><span class="hs-special">)</span><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><span class="hs-identifier">wordFits</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Word"><span class="hs-identifier hs-type">Word</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Line"><span class="hs-identifier hs-type">Line</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-309"></a><a name="wordFits"><a href="Text.PrettyPrint.Boxes.html#wordFits"><span class="hs-identifier">wordFits</span></a></a><span> </span><a name="local-6989586621679027571"><a href="#local-6989586621679027571"><span class="hs-identifier">pw</span></a></a><span> </span><a name="local-6989586621679027572"><a href="#local-6989586621679027572"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679027573"><a href="#local-6989586621679027573"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lLen</span><span> </span><a href="#local-6989586621679027573"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">lLen</span><span> </span><a href="#local-6989586621679027573"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">wLen</span><span> </span><a href="#local-6989586621679027572"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679027571"><span class="hs-identifier hs-var">pw</span></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-312"></a><span class="hs-comment">--  Alignment  -----------------------------------------------------------------</span><span>
</span><a name="line-313"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-comment">-- | @alignHoriz algn n bx@ creates a box of width @n@, with the</span><span>
</span><a name="line-316"></a><span class="hs-comment">--   contents and height of @bx@, horizontally aligned according to</span><span>
</span><a name="line-317"></a><span class="hs-comment">--   @algn@.</span><span>
</span><a name="line-318"></a><span class="hs-identifier">alignHoriz</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-319"></a><a name="alignHoriz"><a href="Text.PrettyPrint.Boxes.html#alignHoriz"><span class="hs-identifier">alignHoriz</span></a></a><span> </span><a name="local-6989586621679027574"><a href="#local-6989586621679027574"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679027575"><a href="#local-6989586621679027575"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679027576"><a href="#local-6989586621679027576"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#align"><span class="hs-identifier hs-var">align</span></a><span> </span><a href="#local-6989586621679027574"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignFirst"><span class="hs-identifier hs-var">AlignFirst</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rows</span><span> </span><a href="#local-6989586621679027576"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027575"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679027576"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">-- | @alignVert algn n bx@ creates a box of height @n@, with the</span><span>
</span><a name="line-322"></a><span class="hs-comment">--   contents and width of @bx@, vertically aligned according to</span><span>
</span><a name="line-323"></a><span class="hs-comment">--   @algn@.</span><span>
</span><a name="line-324"></a><span class="hs-identifier">alignVert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-325"></a><a name="alignVert"><a href="Text.PrettyPrint.Boxes.html#alignVert"><span class="hs-identifier">alignVert</span></a></a><span> </span><a name="local-6989586621679027577"><a href="#local-6989586621679027577"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679027578"><a href="#local-6989586621679027578"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679027579"><a href="#local-6989586621679027579"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#align"><span class="hs-identifier hs-var">align</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignFirst"><span class="hs-identifier hs-var">AlignFirst</span></a><span> </span><a href="#local-6989586621679027577"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679027578"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cols</span><span> </span><a href="#local-6989586621679027579"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027579"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-comment">-- | @align ah av r c bx@ creates an @r@ x @c@ box with the contents</span><span>
</span><a name="line-328"></a><span class="hs-comment">--   of @bx@, aligned horizontally according to @ah@ and vertically</span><span>
</span><a name="line-329"></a><span class="hs-comment">--   according to @av@.</span><span>
</span><a name="line-330"></a><span class="hs-identifier">align</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-331"></a><a name="align"><a href="Text.PrettyPrint.Boxes.html#align"><span class="hs-identifier">align</span></a></a><span> </span><a name="local-6989586621679027580"><a href="#local-6989586621679027580"><span class="hs-identifier">ah</span></a></a><span> </span><a name="local-6989586621679027581"><a href="#local-6989586621679027581"><span class="hs-identifier">av</span></a></a><span> </span><a name="local-6989586621679027582"><a href="#local-6989586621679027582"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679027583"><a href="#local-6989586621679027583"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a href="#local-6989586621679027582"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679027583"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.PrettyPrint.Boxes.html#SubBox"><span class="hs-identifier hs-var">SubBox</span></a><span> </span><a href="#local-6989586621679027580"><span class="hs-identifier hs-var">ah</span></a><span> </span><a href="#local-6989586621679027581"><span class="hs-identifier hs-var">av</span></a><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-comment">-- | Move a box \&quot;up\&quot; by putting it in a larger box with extra rows,</span><span>
</span><a name="line-334"></a><span class="hs-comment">--   aligned to the top.  See the disclaimer for 'moveLeft'.</span><span>
</span><a name="line-335"></a><span class="hs-identifier">moveUp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-336"></a><a name="moveUp"><a href="Text.PrettyPrint.Boxes.html#moveUp"><span class="hs-identifier">moveUp</span></a></a><span> </span><a name="local-6989586621679027584"><a href="#local-6989586621679027584"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679027585"><a href="#local-6989586621679027585"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#alignVert"><span class="hs-identifier hs-var">alignVert</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#top"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rows</span><span> </span><a href="#local-6989586621679027585"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679027584"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027585"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- | Move a box down by putting it in a larger box with extra rows,</span><span>
</span><a name="line-339"></a><span class="hs-comment">--   aligned to the bottom.  See the disclaimer for 'moveLeft'.</span><span>
</span><a name="line-340"></a><span class="hs-identifier">moveDown</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-341"></a><a name="moveDown"><a href="Text.PrettyPrint.Boxes.html#moveDown"><span class="hs-identifier">moveDown</span></a></a><span> </span><a name="local-6989586621679027586"><a href="#local-6989586621679027586"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679027587"><a href="#local-6989586621679027587"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#alignVert"><span class="hs-identifier hs-var">alignVert</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#bottom"><span class="hs-identifier hs-var">bottom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rows</span><span> </span><a href="#local-6989586621679027587"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679027586"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027587"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span class="hs-comment">-- | Move a box left by putting it in a larger box with extra columns,</span><span>
</span><a name="line-344"></a><span class="hs-comment">--   aligned left.  Note that the name of this function is</span><span>
</span><a name="line-345"></a><span class="hs-comment">--   something of a white lie, as this will only result in the box</span><span>
</span><a name="line-346"></a><span class="hs-comment">--   being moved left by the specified amount if it is already in a</span><span>
</span><a name="line-347"></a><span class="hs-comment">--   larger right-aligned context.</span><span>
</span><a name="line-348"></a><span class="hs-identifier">moveLeft</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-349"></a><a name="moveLeft"><a href="Text.PrettyPrint.Boxes.html#moveLeft"><span class="hs-identifier">moveLeft</span></a></a><span> </span><a name="local-6989586621679027588"><a href="#local-6989586621679027588"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679027589"><a href="#local-6989586621679027589"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#alignHoriz"><span class="hs-identifier hs-var">alignHoriz</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#left"><span class="hs-identifier hs-var">left</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cols</span><span> </span><a href="#local-6989586621679027589"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679027588"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027589"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-comment">-- | Move a box right by putting it in a larger box with extra</span><span>
</span><a name="line-352"></a><span class="hs-comment">--   columns, aligned right.  See the disclaimer for 'moveLeft'.</span><span>
</span><a name="line-353"></a><span class="hs-identifier">moveRight</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span>
</span><a name="line-354"></a><a name="moveRight"><a href="Text.PrettyPrint.Boxes.html#moveRight"><span class="hs-identifier">moveRight</span></a></a><span> </span><a name="local-6989586621679027590"><a href="#local-6989586621679027590"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679027591"><a href="#local-6989586621679027591"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#alignHoriz"><span class="hs-identifier hs-var">alignHoriz</span></a><span> </span><a href="Text.PrettyPrint.Boxes.html#right"><span class="hs-identifier hs-var">right</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cols</span><span> </span><a href="#local-6989586621679027591"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679027590"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027591"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-357"></a><span class="hs-comment">--  Implementation  ------------------------------------------------------------</span><span>
</span><a name="line-358"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-comment">-- | Render a 'Box' as a String, suitable for writing to the screen or</span><span>
</span><a name="line-361"></a><span class="hs-comment">--   a file.</span><span>
</span><a name="line-362"></a><span class="hs-identifier">render</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-363"></a><a name="render"><a href="Text.PrettyPrint.Boxes.html#render"><span class="hs-identifier">render</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.PrettyPrint.Boxes.html#renderBox"><span class="hs-identifier hs-var">renderBox</span></a><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-comment">-- XXX make QC properties for takeP</span><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span class="hs-comment">-- | \&quot;Padded take\&quot;: @takeP a n xs@ is the same as @take n xs@, if @n</span><span>
</span><a name="line-368"></a><span class="hs-comment">--   &lt;= length xs@; otherwise it is @xs@ followed by enough copies of</span><span>
</span><a name="line-369"></a><span class="hs-comment">--   @a@ to make the length equal to @n@.</span><span>
</span><a name="line-370"></a><span class="hs-identifier">takeP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679026713"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026713"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026713"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-371"></a><a name="takeP"><a href="Text.PrettyPrint.Boxes.html#takeP"><span class="hs-identifier">takeP</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679027592"><a href="#local-6989586621679027592"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679027592"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-372"></a><span class="hs-identifier">takeP</span><span> </span><a name="local-6989586621679027593"><a href="#local-6989586621679027593"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679027594"><a href="#local-6989586621679027594"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679027594"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679027593"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-373"></a><span class="hs-identifier">takeP</span><span> </span><a name="local-6989586621679027595"><a href="#local-6989586621679027595"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679027596"><a href="#local-6989586621679027596"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679027597"><a href="#local-6989586621679027597"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679027598"><a href="#local-6989586621679027598"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679027597"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.PrettyPrint.Boxes.html#takeP"><span class="hs-identifier hs-var">takeP</span></a><span> </span><a href="#local-6989586621679027595"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027596"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679027598"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">-- | @takePA @ is like 'takeP', but with alignment.  That is, we</span><span>
</span><a name="line-376"></a><span class="hs-comment">--   imagine a copy of @xs@ extended infinitely on both sides with</span><span>
</span><a name="line-377"></a><span class="hs-comment">--   copies of @a@, and a window of size @n@ placed so that @xs@ has</span><span>
</span><a name="line-378"></a><span class="hs-comment">--   the specified alignment within the window; @takePA algn a n xs@</span><span>
</span><a name="line-379"></a><span class="hs-comment">--   returns the contents of this window.</span><span>
</span><a name="line-380"></a><span class="hs-identifier">takePA</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026712"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026712"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679026712"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-381"></a><a name="takePA"><a href="Text.PrettyPrint.Boxes.html#takePA"><span class="hs-identifier">takePA</span></a></a><span> </span><a name="local-6989586621679027599"><a href="#local-6989586621679027599"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679027600"><a href="#local-6989586621679027600"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679027601"><a href="#local-6989586621679027601"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679027603"><span class="hs-identifier hs-var">glue</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#takeP"><span class="hs-identifier hs-var">takeP</span></a><span> </span><a href="#local-6989586621679027600"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027605"><span class="hs-identifier hs-var">numRev</span></a><span> </span><a href="#local-6989586621679027599"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679027601"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">***</span><span> </span><a href="Text.PrettyPrint.Boxes.html#takeP"><span class="hs-identifier hs-var">takeP</span></a><span> </span><a href="#local-6989586621679027600"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027604"><span class="hs-identifier hs-var">numFwd</span></a><span> </span><a href="#local-6989586621679027599"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679027601"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679027602"><span class="hs-identifier hs-var">split</span></a><span>
</span><a name="line-382"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679027602"><a href="#local-6989586621679027602"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679027606"><a href="#local-6989586621679027606"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">first</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027605"><span class="hs-identifier hs-var">numRev</span></a><span> </span><a href="#local-6989586621679027599"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679027606"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679027606"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-383"></a><span>        </span><a name="local-6989586621679027603"><a href="#local-6989586621679027603"><span class="hs-identifier">glue</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">first</span><span> </span><span class="hs-identifier hs-var">reverse</span><span>
</span><a name="line-384"></a><span>        </span><a name="local-6989586621679027604"><a href="#local-6989586621679027604"><span class="hs-identifier">numFwd</span></a></a><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignFirst"><span class="hs-identifier hs-var">AlignFirst</span></a><span>    </span><a name="local-6989586621679027622"><a href="#local-6989586621679027622"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679027622"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-385"></a><span>        </span><span class="hs-identifier">numFwd</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignLast"><span class="hs-identifier hs-var">AlignLast</span></a><span>     </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-386"></a><span>        </span><span class="hs-identifier">numFwd</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignCenter1"><span class="hs-identifier hs-var">AlignCenter1</span></a><span>  </span><a name="local-6989586621679027623"><a href="#local-6989586621679027623"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679027623"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-387"></a><span>        </span><span class="hs-identifier">numFwd</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignCenter2"><span class="hs-identifier hs-var">AlignCenter2</span></a><span>  </span><a name="local-6989586621679028140"><a href="#local-6989586621679028140"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028140"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-388"></a><span>        </span><a name="local-6989586621679027605"><a href="#local-6989586621679027605"><span class="hs-identifier">numRev</span></a></a><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignFirst"><span class="hs-identifier hs-var">AlignFirst</span></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-389"></a><span>        </span><span class="hs-identifier">numRev</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignLast"><span class="hs-identifier hs-var">AlignLast</span></a><span>     </span><a name="local-6989586621679028141"><a href="#local-6989586621679028141"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679028141"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-390"></a><span>        </span><span class="hs-identifier">numRev</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignCenter1"><span class="hs-identifier hs-var">AlignCenter1</span></a><span>  </span><a name="local-6989586621679028142"><a href="#local-6989586621679028142"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028142"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-391"></a><span>        </span><span class="hs-identifier">numRev</span><span> </span><a href="Text.PrettyPrint.Boxes.html#AlignCenter2"><span class="hs-identifier hs-var">AlignCenter2</span></a><span>  </span><a name="local-6989586621679028143"><a href="#local-6989586621679028143"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679028143"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-comment">-- | Generate a string of spaces.</span><span>
</span><a name="line-394"></a><span class="hs-identifier">blanks</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-395"></a><a name="blanks"><a href="Text.PrettyPrint.Boxes.html#blanks"><span class="hs-identifier">blanks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-char">' '</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-comment">-- | Render a box as a list of lines.</span><span>
</span><a name="line-398"></a><span class="hs-identifier">renderBox</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><a name="renderBox"><a href="Text.PrettyPrint.Boxes.html#renderBox"><span class="hs-identifier">renderBox</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a name="local-6989586621679028144"><a href="#local-6989586621679028144"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679028145"><a href="#local-6989586621679028145"><span class="hs-identifier">c</span></a></a><span> </span><a href="Text.PrettyPrint.Boxes.html#Blank"><span class="hs-identifier hs-var">Blank</span></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#resizeBox"><span class="hs-identifier hs-var">resizeBox</span></a><span> </span><a href="#local-6989586621679028144"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679028145"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-401"></a><span class="hs-identifier">renderBox</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a name="local-6989586621679028146"><a href="#local-6989586621679028146"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679028147"><a href="#local-6989586621679028147"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Text"><span class="hs-identifier hs-var">Text</span></a><span> </span><a name="local-6989586621679028148"><a href="#local-6989586621679028148"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#resizeBox"><span class="hs-identifier hs-var">resizeBox</span></a><span> </span><a href="#local-6989586621679028146"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679028147"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679028148"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-402"></a><span class="hs-identifier">renderBox</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a name="local-6989586621679028149"><a href="#local-6989586621679028149"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679028150"><a href="#local-6989586621679028150"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Row"><span class="hs-identifier hs-var">Row</span></a><span> </span><a name="local-6989586621679028151"><a href="#local-6989586621679028151"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#resizeBox"><span class="hs-identifier hs-var">resizeBox</span></a><span> </span><a href="#local-6989586621679028149"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679028150"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-403"></a><span>                                       </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679028152"><span class="hs-identifier hs-var">merge</span></a><span>
</span><a name="line-404"></a><span>                                       </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#renderBoxWithRows"><span class="hs-identifier hs-var">renderBoxWithRows</span></a><span> </span><a href="#local-6989586621679028149"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-405"></a><span>                                       </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679028151"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-406"></a><span>                           </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679028152"><a href="#local-6989586621679028152"><span class="hs-identifier">merge</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">repeat</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span class="hs-identifier">renderBox</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a name="local-6989586621679028153"><a href="#local-6989586621679028153"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679028154"><a href="#local-6989586621679028154"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Col"><span class="hs-identifier hs-var">Col</span></a><span> </span><a name="local-6989586621679028155"><a href="#local-6989586621679028155"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#resizeBox"><span class="hs-identifier hs-var">resizeBox</span></a><span> </span><a href="#local-6989586621679028153"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679028154"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-409"></a><span>                                       </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#renderBoxWithCols"><span class="hs-identifier hs-var">renderBoxWithCols</span></a><span> </span><a href="#local-6989586621679028154"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>                                       </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679028155"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span class="hs-identifier">renderBox</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-var">Box</span></a><span> </span><a name="local-6989586621679028156"><a href="#local-6989586621679028156"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679028157"><a href="#local-6989586621679028157"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#SubBox"><span class="hs-identifier hs-var">SubBox</span></a><span> </span><a name="local-6989586621679028158"><a href="#local-6989586621679028158"><span class="hs-identifier">ha</span></a></a><span> </span><a name="local-6989586621679028159"><a href="#local-6989586621679028159"><span class="hs-identifier">va</span></a></a><span> </span><a name="local-6989586621679028160"><a href="#local-6989586621679028160"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#resizeBoxAligned"><span class="hs-identifier hs-var">resizeBoxAligned</span></a><span> </span><a href="#local-6989586621679028156"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679028157"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679028158"><span class="hs-identifier hs-var">ha</span></a><span> </span><a href="#local-6989586621679028159"><span class="hs-identifier hs-var">va</span></a><span>
</span><a name="line-413"></a><span>                                       </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.PrettyPrint.Boxes.html#renderBox"><span class="hs-identifier hs-var">renderBox</span></a><span>
</span><a name="line-414"></a><span>                                       </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679028160"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span class="hs-comment">-- | Render a box as a list of lines, using a given number of rows.</span><span>
</span><a name="line-417"></a><span class="hs-identifier">renderBoxWithRows</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-418"></a><a name="renderBoxWithRows"><a href="Text.PrettyPrint.Boxes.html#renderBoxWithRows"><span class="hs-identifier">renderBoxWithRows</span></a></a><span> </span><a name="local-6989586621679028161"><a href="#local-6989586621679028161"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679028162"><a href="#local-6989586621679028162"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#renderBox"><span class="hs-identifier hs-var">renderBox</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028162"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">{</span><span class="hs-identifier">rows</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679028161"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-comment">-- | Render a box as a list of lines, using a given number of columns.</span><span>
</span><a name="line-421"></a><span class="hs-identifier">renderBoxWithCols</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-422"></a><a name="renderBoxWithCols"><a href="Text.PrettyPrint.Boxes.html#renderBoxWithCols"><span class="hs-identifier">renderBoxWithCols</span></a></a><span> </span><a name="local-6989586621679028163"><a href="#local-6989586621679028163"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679028164"><a href="#local-6989586621679028164"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#renderBox"><span class="hs-identifier hs-var">renderBox</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028164"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">{</span><span class="hs-identifier">cols</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679028163"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span class="hs-comment">-- | Resize a rendered list of lines.</span><span>
</span><a name="line-425"></a><span class="hs-identifier">resizeBox</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-426"></a><a name="resizeBox"><a href="Text.PrettyPrint.Boxes.html#resizeBox"><span class="hs-identifier">resizeBox</span></a></a><span> </span><a name="local-6989586621679028165"><a href="#local-6989586621679028165"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679028166"><a href="#local-6989586621679028166"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#takeP"><span class="hs-identifier hs-var">takeP</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#blanks"><span class="hs-identifier hs-var">blanks</span></a><span> </span><a href="#local-6989586621679028166"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028165"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#takeP"><span class="hs-identifier hs-var">takeP</span></a><span> </span><span class="hs-char">' '</span><span> </span><a href="#local-6989586621679028166"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span class="hs-comment">-- | Resize a rendered list of lines, using given alignments.</span><span>
</span><a name="line-429"></a><span class="hs-identifier">resizeBoxAligned</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-430"></a><a name="resizeBoxAligned"><a href="Text.PrettyPrint.Boxes.html#resizeBoxAligned"><span class="hs-identifier">resizeBoxAligned</span></a></a><span> </span><a name="local-6989586621679028167"><a href="#local-6989586621679028167"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679028168"><a href="#local-6989586621679028168"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679028169"><a href="#local-6989586621679028169"><span class="hs-identifier">ha</span></a></a><span> </span><a name="local-6989586621679028170"><a href="#local-6989586621679028170"><span class="hs-identifier">va</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.PrettyPrint.Boxes.html#takePA"><span class="hs-identifier hs-var">takePA</span></a><span> </span><a href="#local-6989586621679028170"><span class="hs-identifier hs-var">va</span></a><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#blanks"><span class="hs-identifier hs-var">blanks</span></a><span> </span><a href="#local-6989586621679028168"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028167"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Text.PrettyPrint.Boxes.html#takePA"><span class="hs-identifier hs-var">takePA</span></a><span> </span><a href="#local-6989586621679028169"><span class="hs-identifier hs-var">ha</span></a><span> </span><span class="hs-char">' '</span><span> </span><a href="#local-6989586621679028168"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span class="hs-comment">-- | A convenience function for rendering a box to stdout.</span><span>
</span><a name="line-433"></a><span class="hs-identifier">printBox</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.PrettyPrint.Boxes.html#Box"><span class="hs-identifier hs-type">Box</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-434"></a><a name="printBox"><a href="Text.PrettyPrint.Boxes.html#printBox"><span class="hs-identifier">printBox</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">putStr</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.PrettyPrint.Boxes.html#render"><span class="hs-identifier hs-var">render</span></a><span>
</span><a name="line-435"></a></pre></body></html>